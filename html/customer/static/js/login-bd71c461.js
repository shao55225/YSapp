import{x as a,g as e,y as s,A as t,B as l,C as i,h as d,D as r,F as o,G as c,H as p,I as n,J as m,f as u,K as g,o as v,b as f,d as h,a as w,w as b,L as y,M as x,u as _,N as k,e as N,O as U,P as V}from"./.pnpm-9c274078.js";import{_ as C,s as R}from"./index-e716b57f.js";const q=""+new URL("../svg/login1-f956a0f5.svg",import.meta.url).href,L=""+new URL("../svg/login2-ec1a8480.svg",import.meta.url).href,S=""+new URL("../svg/login3-e8df7a1e.svg",import.meta.url).href,I=""+new URL("../svg/refurbish-fe91c2d4.svg",import.meta.url).href,z=a=>(U("data-v-98d8187f"),a=a(),V(),a),E={class:"login-wrapper"},F={class:"login-jh"},P={class:"tips"},j=x('<h3 style="font-size:28px;font-family:sans-serif !important;letter-spacing:2px;margin:0;line-height:40px;vertical-align:bottom;color:#333333;" data-v-98d8187f> 欢迎登录CMS客服系统 </h3><div class="tips-item" data-v-98d8187f><img src="'+q+'" data-v-98d8187f><div data-v-98d8187f><p class="h" data-v-98d8187f>操作简单</p><p data-v-98d8187f>无需繁琐配置，一键采集即可快速拥有上万条数据</p></div></div><div class="tips-item" data-v-98d8187f><img src="'+L+'" data-v-98d8187f><div data-v-98d8187f><p class="h" data-v-98d8187f>聚合碎片数据</p><p data-v-98d8187f>深度挖掘数据价值，提升体验促进转化</p></div></div><div class="tips-item" data-v-98d8187f><img src="'+S+'" data-v-98d8187f><div data-v-98d8187f><p class="h" data-v-98d8187f>丰富插件系统</p><p data-v-98d8187f>快速的在不同系统中切换，插件齐全，资源丰富</p></div></div>',4),A={class:"sug_size"},H=z((()=>h("p",null,[N(" 建议使用"),h("span",null,"Chrome"),N(" 浏览器进入管理页面,推荐分辨率 "),h("span",null,"1920*1080")],-1))),M=z((()=>h("p",{class:"label"},"登录账号",-1))),O=z((()=>h("p",{class:"label"},"登录密码",-1))),T=z((()=>h("p",{class:"label",style:{"margin-bottom":"2vh"}},"验证码",-1))),B={class:"flex captcha"},K={class:"captchaImg"},$=["src"],D=z((()=>h("img",{src:I,alt:""},null,-1))),G=C({__name:"login",setup(x){a(!1),e.closeAll();const U=s(),V=t(),C=l(),{$http:q}=C.appContext.config.globalProperties,L=a(),S=i(),I=d({captcha:"",id:"",password:"",userName:"",loading:!1});r((()=>{G.get(),z.accessibility()}));const z={accessibility(){var a;if(null==(a=U.query)?void 0:a.token){const a=o.service({lock:!0,text:"正在登录中...",background:"rgba(255, 255, 255, 0.9)"});setTimeout((()=>{let e=U.query.token;q.post("/api/v1/customer/auth/cmsLogin",{token:e}).then((async({data:a})=>{R(a.token),V.commit("SETUSERINFO",a.user),await S.push({name:"HomePage"})})).finally((()=>{a.close()}))}),500)}},submit(a){a&&a.validate(((a,e)=>{a&&(I.loading=!0,q.post("/api/v1/customer/auth/login",{userName:I.userName,password:c.exports(I.password),id:I.id,captcha:I.captcha,loginUrl:location.href}).then((async({data:a})=>{await R(a.token),await V.commit("SETUSERINFO",a.user),await S.push({name:3==a.user.role?"Survey":"HomePage"})})).finally((()=>{I.loading=!1})).catch((({response:a})=>{var e;let s=null==(e=a.data)?void 0:e.message;["账号不存在或密码错误","验证码不正确"].includes(s)&&G.get()})))}))}},G=d({src:"",get:()=>q.get("/api/v1/customer/auth/captcha").then((({data:a})=>{G.src=a.img,I.id=a.id,I.captcha=""}))}),J=d({userName:[{required:!0,message:"请输入账号",trigger:"change"},{min:3,max:15,message:"长度为3～15个字符",trigger:"change"},{pattern:/[0-9|A-Z|a-z]{3,15}$/,message:"仅支持数字、字母组合",trigger:"change"}],captcha:{required:!0,message:"请输入验证码"},password:[{required:!0,message:"请输入登录密码",trigger:"change"},{min:6,max:20,message:"长度为6～20个字符",trigger:"change"}]});return(a,e)=>{const s=p,t=n,l=m,i=u,d=g;return v(),f("div",E,[h("div",F,[h("div",P,[j,h("div",A,[w(s,null,{default:b((()=>[w(_(k))])),_:1}),H])]),w(d,{ref_key:"ruleFormRef",ref:L,"label-width":"0",model:I,rules:J,class:"form",size:"large","hide-required-asterisk":!1,onKeyup:e[6]||(e[6]=y((a=>z.submit(L.value)),["enter"]))},{default:b((()=>[w(l,{prop:"userName"},{default:b((()=>[M,w(t,{modelValue:I.userName,"onUpdate:modelValue":e[0]||(e[0]=a=>I.userName=a),modelModifiers:{trim:!0},clearable:"",class:"input",placeholder:"请输入您的登录账号"},null,8,["modelValue"])])),_:1}),w(l,{prop:"password"},{default:b((()=>[O,w(t,{modelValue:I.password,"onUpdate:modelValue":e[1]||(e[1]=a=>I.password=a),clearable:"",type:"password",class:"input","show-password":"",placeholder:"请输入您的登录密码"},null,8,["modelValue"])])),_:1}),w(l,{prop:"captcha",class:"captchaBox"},{default:b((()=>[T,h("div",B,[w(t,{modelValue:I.captcha,"onUpdate:modelValue":e[2]||(e[2]=a=>I.captcha=a),clearable:"",class:"input",placeholder:"验证码"},null,8,["modelValue"]),h("div",K,[h("img",{src:G.src,class:"point",style:{width:"100px",height:"44px"},onClick:e[3]||(e[3]=a=>G.get())},null,8,$),w(i,{type:"primary",link:"",onClick:e[4]||(e[4]=a=>G.get()),class:"change"},{default:b((()=>[D])),_:1})])])])),_:1}),w(l,null,{default:b((()=>[w(i,{class:"submit",type:"primary",loading:I.loading,onClick:e[5]||(e[5]=a=>z.submit(L.value))},{default:b((()=>[N(" 登录 ")])),_:1},8,["loading"])])),_:1})])),_:1},8,["model","rules"])])])}}},[["__scopeId","data-v-98d8187f"]]);export{G as default};

import{x as e,D as a,ap as l,a9 as t,ac as i,h as o,R as n,o as s,b as d,d as v,p as r,u as c,c as u,Q as p,t as y,ai as f,O as m,P as x}from"./.pnpm-9c274078.js";import{_ as g}from"./index-e716b57f.js";const h=e=>(m("data-v-0cdfac8b"),e=e(),x(),e),b={class:"line-box"},z={class:"top-right"},K={class:"legend"},$={class:"currDate"},k=h((()=>v("span",{class:"tag",style:{background:"#899bff"}},null,-1))),C={key:0},w={key:1},D={key:2},M={class:"lastDate"},Y=h((()=>v("span",{class:"tag",style:{background:"#f0866a"}},null,-1))),F={key:0},S={key:1},T={key:2},_=g({__name:"line2",props:{load:{},list:{type:Object,default:()=>{}},type:{type:Number,default:1},survey:{type:Boolean,default:!1}},emits:["update:active"],setup(m,{emit:x}){const g=m,h=e();a((()=>{V.chart=l(B.value),_(),t((()=>g.list),(()=>{_()}))}));const _=()=>{let e=i(g.list);if(1!=I.activeKey||h.value)if(h.value){O.value=Math.floor((new Date(h.value[1]+" 00:00:00")-new Date(h.value[0]+" 00:00:00"))/864e5),O.value=O.value<1?1:O.value+1;let t=(null==e?void 0:e.day)||[];a=t.slice(t.findIndex((e=>e.day===h.value[1])),t.findIndex((e=>e.day===h.value[0]))+1).reverse(),l=t.slice(t.findIndex((e=>e.day===h.value[0]))+1,t.findIndex((e=>e.day===h.value[0]))+O.value+1).reverse()}else{let t=(null==e?void 0:e.day)||[];a=t.slice(0,I.activeKey).reverse(),l=t.slice(I.activeKey,Number(I.activeKey+I.activeKey)).reverse()}else{let t=(null==e?void 0:e.hour)||[];var a=t.slice(0,24).reverse(),l=t.slice(24).reverse()}let t=a.map((e=>1!=I.activeKey||h.value?e.day:e.datetime)),o=a.map((e=>e.amount)),n=l.map((e=>e.amount));I.currMap=a,I.lastMap=l,P(t,o,n)},I=o({activeKey:7,currMap:[],lastMap:[]}),L=e=>{if(e==I.activeKey&&!h.value)return!1;g.load().then((()=>{x("update:active",e),I.activeKey=e,h.value=void 0,_()}))},{activeKey:O,currMap:A,lastMap:j}=n(I),B=e(null),V={chart:null};function N(e){var a,l;if(g.list.day)return new Date((null==(a=g.list.day.at(-1))?void 0:a.day)+" 00:00:00").getTime()>e.getTime()||e.getTime()>new Date((null==(l=g.list.day[0])?void 0:l.day)+" 00:00:00").getTime()}function G(e,a){const l=e=>{var a=e;return 1==e.toString().length&&(a="0"+e),a};var t=a?new Date(a):new Date,i=t.getTime()+864e5*e;t.setTime(i);var o=t.getFullYear(),n=t.getMonth(),s=t.getDate();return o+"-"+(n=l(n+1))+"-"+(s=l(s))}const P=(e,a,l)=>{let t=[1!=I.activeKey||h.value?`近${I.activeKey}天`:"今天",1!=I.activeKey||h.value?`上${I.activeKey}天`:"昨天"];V.chart.setOption({tooltip:{trigger:"axis",formatter:function(e){return(e=>{let a=`<div style='display:flex;align-items:center;'><span style="\n      background: #899BFF;width: 14px;\n        height: 10px; border-radius: 2px; margin: 0 4px 2px 0;"></span>\n      <span style='font-size:12px;color:#C2C3C8;'>${e[0].name}</span></div>`,l=1!=I.activeKey||h.value?G(-I.activeKey,e[0].name):G(-1,e[0].name)+e[0].name.substring(10),t=`<div style='display:flex;align-items:center;'><span style="\n      background: #F0866A;width: 14px;\n        height: 10px; border-radius: 2px; margin: 0 4px 2px 0;"></span>\n        <span style='font-size:12px;color:#C2C3C8;'>${l}</span></div>`;var i=I.currMap.filter((a=>1!=I.activeKey||h.value?a.day==e[0].name:a.datetime==e[0].name))[0],o=I.lastMap.filter((e=>1!=I.activeKey||h.value?e.day==l:e.datetime==l))[0];if(1==g.type)var n="<div style='padding:0 6px;'>"+a+`<div style='font-size:12px;color:#666666;'>已完成: ${(null==i?void 0:i.completed)||"0"}元</div><div style='font-size:12px;color:#666666;'>待付款: ${(null==i?void 0:i.valid)||"0"}元</div><div style='font-size:12px;color:#666666;'>已关闭: ${(null==i?void 0:i.closed)||"0"}元</div>`+t+`<div style='font-size:12px;color:#666666;'>已完成: ${(null==o?void 0:o.completed)||"0"}元</div><div style='font-size:12px;color:#666666;'>待付款: ${(null==o?void 0:o.valid)||"0"}元</div><div style='font-size:12px;color:#666666;'>已关闭: ${(null==o?void 0:o.closed)||"0"}元</div></div>`;2==g.type&&(n="<div style='padding:0 6px;'>"+a+`<div style='font-size:12px;color:#666666;'>已完成: ${(null==i?void 0:i.completed)||"0"}元</div><div style='font-size:12px;color:#666666;'>待处理: ${(null==i?void 0:i.frozen)||"0"}元</div><div style='font-size:12px;color:#666666;'>已关闭: ${(null==i?void 0:i.closed)||"0"}元</div>`+t+`<div style='font-size:12px;color:#666666;'>已完成: ${(null==o?void 0:o.completed)||"0"}元</div><div style='font-size:12px;color:#666666;'>待处理: ${(null==o?void 0:o.frozen)||"0"}元</div><div style='font-size:12px;color:#666666;'>已关闭: ${(null==o?void 0:o.closed)||"0"}元</div></div>`);3==g.type&&(n="<div style='padding:0 6px;'>"+a+`<div style='font-size:12px;color:#666666;'>累计分佣: ${(null==i?void 0:i.amount)||"0"}元</div>`+t+`<div style='font-size:12px;color:#666666;'>累计分佣: ${(null==o?void 0:o.amount)||"0"}元</div></div>`);return n})(e)}},grid:{top:"20%",left:"0%",right:"1%",bottom:"2%",containLabel:!0},xAxis:{type:"category",boundaryGap:!1,axisLabel:{color:"#C2C3C8"},data:(null==e?void 0:e.length)?e:["1","2","3","4","5","6","7"],axisLabel:{color:"#999999",formatter:function(e,a){let l=1!=I.activeKey||h.value?e.indexOf("-"):e.indexOf(" ");return 1!=I.activeKey||h.value?e.substring(l+1):e.substring(l+1,l+6)}},axisTick:{show:!1}},yAxis:{type:"value",axisLabel:{color:"#999999"},splitLine:{show:!1}},series:[{name:t[0]||"近7天",type:"line",data:(null==a?void 0:a.length)?a:[14,19,15,8,30,20,14],itemStyle:{color:"#899BFF"},symbol:"none",areaStyle:{color:{x:0,y:0,x2:0,y2:1,colorStops:[{offset:0,color:"rgba(137, 155, 255, 0.4)"},{offset:.7,color:"rgba(137, 155, 255, 0)"}]}},smooth:!0},{name:t[1]||"上7天",type:"line",data:(null==l?void 0:l.length)?l:[25,18,6,19,8,35,14],itemStyle:{color:"#F0866A"},symbol:"none",areaStyle:{color:{x:0,y:0,x2:0,y2:1,colorStops:[{offset:0,color:"rgba(240, 134, 106, 0.4)"},{offset:.7,color:"rgba(240, 134, 106, 0)"}]}},smooth:!0}]},!0),window.onresize=function(){V.chart.resize()}};return(e,a)=>{var l,t,i,o,n,x,I,V,G,P;const Q=f;return s(),d("div",b,[v("div",{ref_key:"classChart",ref:B,style:{width:"100%",height:"230px"}},null,512),v("div",z,[v("span",{onClick:a[0]||(a[0]=e=>L(1)),class:r({active:1==c(O)&&!h.value})},"今天",2),v("span",{onClick:a[1]||(a[1]=e=>L(7)),class:r({active:7==c(O)&&!h.value})},"7天",2),v("span",{onClick:a[2]||(a[2]=e=>L(15)),class:r({active:15==c(O)&&!h.value})},"15天",2),v("span",{onClick:a[3]||(a[3]=e=>L(30)),class:r({active:30==c(O)&&!h.value})},"1月",2),m.list.day?(s(),u(Q,{key:0,modelValue:h.value,"onUpdate:modelValue":a[4]||(a[4]=e=>h.value=e),style:{width:"260px"},type:"daterange","range-separator":"～",format:"YYYY/MM/DD","value-format":"YYYY-MM-DD","start-placeholder":"开始时间","end-placeholder":"结束时间",size:"small","disabled-date":N,onChange:a[5]||(a[5]=e=>{e?g.load().then((()=>{_()})):L(7)})},null,8,["modelValue"])):p("",!0)]),v("div",K,[v("div",$,[k,1!=c(O)||h.value?(null==(l=c(A)[0])?void 0:l.day)===(null==(t=c(A)[c(A).length-1||0])?void 0:t.day)?(s(),d("span",w,y(null==(i=c(A)[c(A).length-1||0])?void 0:i.day),1)):(s(),d("span",D,y(null==(o=c(A)[0])?void 0:o.day)+" 至 "+y(null==(n=c(A)[c(A).length-1||0])?void 0:n.day),1)):(s(),d("span",C,"今天"))]),v("div",M,[Y,1!=c(O)||h.value?(null==(x=c(j)[0])?void 0:x.day)===(null==(I=c(j)[c(j).length-1||0])?void 0:I.day)?(s(),d("span",S,y(null==(V=c(j)[0])?void 0:V.day),1)):(s(),d("span",T,y(null==(G=c(j)[0])?void 0:G.day)+" 至 "+y(null==(P=c(j)[c(j).length-1||0])?void 0:P.day),1)):(s(),d("span",F,"昨天"))])])])}}},[["__scopeId","data-v-0cdfac8b"]]);export{_ as l};

import{x as e,D as a,ap as l,a9 as t,ac as i,h as n,R as s,o,b as d,c as r,w as v,a as c,u,a3 as p,Q as y,d as f,q as g,p as x,t as m,ag as h,ah as b,ai as k,O as z,P as K}from"./.pnpm-9c274078.js";import{_ as $}from"./index-e716b57f.js";const C=e=>(z("data-v-b0275b05"),e=e(),K(),e),w={class:"line-box"},D={key:1,class:"top-right",style:{gap:"0",left:"16px"}},M={class:"currDate"},Y=C((()=>f("span",{class:"tag",style:{background:"#899bff"}},null,-1))),S={key:0},T={key:1},F={key:2},_={class:"lastDate"},V=C((()=>f("span",{class:"tag",style:{background:"#f0866a"}},null,-1))),I={key:0},L={key:1},N={key:2},O=$({__name:"line3",props:{load:{},list:{type:Object,default:()=>{}},type:{type:Number,default:1},survey:{type:Boolean,default:!1},height:{type:String,default:"230px"},custom:{type:Boolean,default:!0}},emits:["update:active"],setup(z,{emit:K}){const $=z,C=e();function O(e){var a,l;if($.list.day)return new Date((null==(a=$.list.day.at(-1))?void 0:a.day)+" 00:00:00").getTime()>e.getTime()||e.getTime()>new Date((null==(l=$.list.day[0])?void 0:l.day)+" 00:00:00").getTime()}a((()=>{H.chart=l(E.value),A(),t((()=>$.list),(()=>{A()}))}));const A=async()=>{let e=i($.list);if(1!=B.activeKey||C.value)if(C.value){let t=(null==e?void 0:e.day)||[];q.value=Math.floor((new Date(C.value[1]+" 00:00:00")-new Date(C.value[0]+" 00:00:00"))/864e5),q.value=q.value<1?1:q.value+1;a=t.slice(t.findIndex((e=>e.day===C.value[1])),t.findIndex((e=>e.day===C.value[0]))+1).reverse(),l=t.slice(t.findIndex((e=>e.day===C.value[0]))+1,t.findIndex((e=>e.day===C.value[0]))+q.value+1).reverse()}else{let t=(null==e?void 0:e.day)||[];a=t.slice(0,B.activeKey).reverse(),l=t.slice(B.activeKey,Number(B.activeKey+B.activeKey)).reverse()}else{let t=(null==e?void 0:e.hour)||[];var a=t.slice(0,24).reverse(),l=t.slice(24).reverse()}let t=a.map((e=>1!=B.activeKey||C.value?e.day:e.datetime)),n=a.map((e=>1==B.kind?e.recharge:2==B.kind?e.consume:e.gift)),s=l.map((e=>1==B.kind?e.recharge:2==B.kind?e.consume:e.gift));B.currMap=a,B.lastMap=l,W(t,n,s)},B=n({activeKey:7,kind:1,currMap:[],lastMap:[],activeName:1}),j=e=>{if(e==B.activeKey&&!C.value)return!1;$.load().then((()=>{K("update:active",e),B.activeKey=e,C.value=void 0,A()}))},U=e=>{if(e===B.kind)return!1;B.kind=e,A()},{activeKey:q,currMap:G,lastMap:P,kind:Q,activeName:R}=s(B),E=e(null),H={chart:null};function J(e,a){const l=e=>{var a=e;return 1==e.toString().length&&(a="0"+e),a};var t=a?new Date(a):new Date,i=t.getTime()+864e5*e;t.setTime(i);var n=t.getFullYear(),s=t.getMonth(),o=t.getDate();return n+"-"+(s=l(s+1))+"-"+(o=l(o))}const W=(e,a,l)=>{let t=[1==B.activeKey?"今天":`近${B.activeKey}天`,1==B.activeKey?"昨天":`上${B.activeKey}天`];H.chart.setOption({tooltip:{trigger:"axis",formatter:function(e){return(e=>{let a=`<div style='display:flex;align-items:center;'><span style="\n      background: #899BFF;width: 14px;\n        height: 10px; border-radius: 2px; margin: 0 4px 2px 0;"></span>\n      <span style='font-size:12px;color:#C2C3C8;'>${e[0].name}</span></div>`,l=1!=B.activeKey||C.value?J(-B.activeKey,e[0].name):J(-1,e[0].name)+e[0].name.substring(10),t=`<div style='display:flex;align-items:center;'><span style="\n      background: #F0866A;width: 14px;\n        height: 10px; border-radius: 2px; margin: 0 4px 2px 0;"></span>\n        <span style='font-size:12px;color:#C2C3C8;'>${l}</span></div>`;var i=B.currMap.filter((a=>1!=B.activeKey||C.value?a.day==e[0].name:a.datetime==e[0].name))[0],n=B.lastMap.filter((e=>1!=B.activeKey||C.value?e.day==l:e.datetime==l))[0];if(1==$.type)var s="<div style='padding:0 6px;'>"+a+`<div style='font-size:12px;color:#666666;'>已完成: ${(null==i?void 0:i.completed)||0}元</div><div style='font-size:12px;color:#666666;'>待付款: ${(null==i?void 0:i.valid)||0}元</div><div style='font-size:12px;color:#666666;'>已关闭: ${(null==i?void 0:i.closed)||0}元</div>`+t+`<div style='font-size:12px;color:#666666;'>已完成: ${(null==n?void 0:n.completed)||0}元</div><div style='font-size:12px;color:#666666;'>待付款: ${(null==n?void 0:n.valid)||0}元</div><div style='font-size:12px;color:#666666;'>已关闭: ${(null==n?void 0:n.closed)||0}元</div></div>`;2==$.type&&(s="<div style='padding:0 6px;'>"+a+`<div style='font-size:12px;color:#666666;'>已完成: ${(null==i?void 0:i.completed)||0}元</div><div style='font-size:12px;color:#666666;'>待处理: ${(null==i?void 0:i.frozen)||0}元</div><div style='font-size:12px;color:#666666;'>已关闭: ${(null==i?void 0:i.closed)||0}元</div>`+t+`<div style='font-size:12px;color:#666666;'>已完成: ${(null==n?void 0:n.completed)||0}元</div><div style='font-size:12px;color:#666666;'>待处理: ${(null==n?void 0:n.frozen)||0}元</div><div style='font-size:12px;color:#666666;'>已关闭: ${(null==n?void 0:n.closed)||0}元</div></div>`);3==$.type&&(s="<div style='padding:0 6px;'>"+a+`<div style='font-size:12px;color:#666666;'>${1==B.kind?"充值":2==B.kind?"消费":"赠送"}金币: ${(1==B.kind?null==i?void 0:i.recharge:2==B.kind?null==i?void 0:i.consume:null==i?void 0:i.gift)||0}个</div>`+t+`<div style='font-size:12px;color:#666666;'>${1==B.kind?"充值":2==B.kind?"消费":"赠送"}金币: ${(1==B.kind?null==n?void 0:n.recharge:2==B.kind?null==n?void 0:n.consume:null==n?void 0:n.gift)||0}个</div></div>`);return s})(e)}},grid:{top:"20%",left:"0%",right:"1%",bottom:"2%",containLabel:!0},xAxis:{type:"category",boundaryGap:!1,axisLabel:{color:"#C2C3C8"},data:(null==e?void 0:e.length)?e:["1","2","3","4","5","6","7"],axisLabel:{color:"#999999",formatter:function(e,a){let l=1!=B.activeKey||C.value?e.indexOf("-"):e.indexOf(" ");return 1!=B.activeKey||C.value?e.substring(l+1):e.substring(l+1,l+6)}},axisTick:{show:!1}},yAxis:{type:"value",axisLabel:{color:"#999999"},splitLine:{show:!1}},series:[{name:t[0]||"近7天",type:"line",data:(null==a?void 0:a.length)?a:[14,19,15,8,30,20,14],itemStyle:{color:"#899BFF"},symbol:"none",areaStyle:{color:{x:0,y:0,x2:0,y2:1,colorStops:[{offset:0,color:"rgba(137, 155, 255, 0.4)"},{offset:.7,color:"rgba(137, 155, 255, 0)"}]}},smooth:!0},{name:t[1]||"上7天",type:"line",data:(null==l?void 0:l.length)?l:[25,18,6,19,8,35,14],itemStyle:{color:"#F0866A"},symbol:"none",areaStyle:{color:{x:0,y:0,x2:0,y2:1,colorStops:[{offset:0,color:"rgba(240, 134, 106, 0.4)"},{offset:.7,color:"rgba(240, 134, 106, 0)"}]}},smooth:!0}]},!0),window.onresize=function(){H.chart.resize()}};return(e,a)=>{var l,t,i,n,s,K,H,J,W,X;const Z=h,ee=b,ae=k;return o(),d("div",w,["230px"!=z.height?(o(),r(ee,{key:0,modelValue:u(R),"onUpdate:modelValue":a[0]||(a[0]=e=>p(R)?R.value=e:null),style:{"--el-font-size-base":"14px"},onTabChange:a[1]||(a[1]=e=>U(B.activeName))},{default:v((()=>[c(Z,{label:"充值金币",name:1}),c(Z,{label:"消费金币",name:2}),c(Z,{label:"赠送金币",name:3})])),_:1},8,["modelValue"])):y("",!0),f("div",{ref_key:"classChart",ref:E,style:g({width:"100%",height:z.height})},null,4),"230px"==z.height?(o(),d("div",D,[f("span",{style:{"border-radius":"13px 0 0 13px"},class:x({active:1==u(Q)}),onClick:a[2]||(a[2]=e=>U(1))}," 充值 ",2),f("span",{style:{"border-radius":"0","border-left":"0","border-right":"0"},class:x({active:2==u(Q)}),onClick:a[3]||(a[3]=e=>U(2))}," 消费 ",2),f("span",{style:{"border-radius":"0 13px 13px 0"},class:x({active:3==u(Q)}),onClick:a[4]||(a[4]=e=>U(3))}," 赠送 ",2)])):y("",!0),f("div",{class:"top-right",style:g({left:"230px"==z.height?"220px":"80px",top:"230px"==z.height?"0":"72px"})},[f("span",{onClick:a[5]||(a[5]=e=>j(1)),class:x({active:1==u(q)&&!C.value})},"今天",2),f("span",{onClick:a[6]||(a[6]=e=>j(7)),class:x({active:7==u(q)&&!C.value})},"7天",2),f("span",{onClick:a[7]||(a[7]=e=>j(15)),class:x({active:15==u(q)&&!C.value})},"15天",2),f("span",{onClick:a[8]||(a[8]=e=>j(30)),class:x({active:30==u(q)&&!C.value})},"1月",2),z.list.day&&z.custom?(o(),r(ae,{key:0,modelValue:C.value,"onUpdate:modelValue":a[9]||(a[9]=e=>C.value=e),style:{width:"260px"},type:"daterange","range-separator":"～",format:"YYYY/MM/DD","value-format":"YYYY-MM-DD","start-placeholder":"开始时间","end-placeholder":"结束时间",size:"small","disabled-date":O,onChange:a[10]||(a[10]=e=>{e?$.load().then((()=>{A()})):j(7)})},null,8,["modelValue"])):y("",!0)],4),f("div",{class:x("230px"==z.height?"legend":"legend1")},[f("div",M,[Y,1!=u(q)||C.value?y("",!0):(o(),d("span",S,"今天")),(null==(l=u(G)[0])?void 0:l.day)===(null==(t=u(G)[u(G).length-1||0])?void 0:t.day)?(o(),d("span",T,m(null==(i=u(G)[0])?void 0:i.day),1)):(o(),d("span",F,m(null==(n=u(G)[0])?void 0:n.day)+" 至 "+m(null==(s=u(G)[u(G).length-1||0])?void 0:s.day),1))]),f("div",_,[V,1!=u(q)||C.value?y("",!0):(o(),d("span",I,"昨天")),(null==(K=u(P)[0])?void 0:K.day)===(null==(H=u(P)[u(P).length-1||0])?void 0:H.day)?(o(),d("span",L,m(null==(J=u(P)[0])?void 0:J.day),1)):(o(),d("span",N,m(null==(W=u(P)[0])?void 0:W.day)+" 至 "+m(null==(X=u(P)[u(P).length-1||0])?void 0:X.day),1))])],2)])}}},[["__scopeId","data-v-b0275b05"]]);export{O as l};

import{_ as e}from"./index-b0450432.js";import{_ as t,p as n}from"./index-886f43d3.js";import{v as s,o as a,w as l,b9 as o,R as c,Q as i,u as r,ba as d,bh as p,bk as m,F as u,bm as y,bo as v,bf as g,bj as f,a4 as h,l as x,bb as k,bc as b,h as w,bd as L,be as I}from"./vendor-others-96825896.js";const R=e=>(L("data-v-2ae9ec57"),e=e(),I(),e),_={key:0,class:"no_message"},M=["data-msg"],j={key:0,class:"sys-notice"},A=R((()=>g("span",{class:"line"},null,-1))),H=["innerHTML"],S=R((()=>g("span",{class:"line"},null,-1))),T=["src"],z={class:"mes-text"},C={class:"time"},E={key:0,class:"mes-name"},N={key:1,class:"mes-name"},F=["innerHTML"],O=["src"],P=["src"],U=["src"],$=["src"],q={key:0,class:"order2",style:{"font-size":"14px",padding:"0 16px",width:"347px"}},B={style:{color:"#4b82fa"}},G={key:0,style:{margin:"8px 0"}},J={key:0,style:{color:"#52c41a"}},Q={key:1,style:{color:"#ff4d4f"}},V={key:1,style:{display:"flex","line-height":"1"}},W={style:{"flex-shrink":"0"}},D=["innerHTML"],K={key:1,class:"order"},X={class:"title"},Y={class:"num"},Z={class:"num"},ee={key:0,style:{color:"#f7ad1e"}},te={key:1,style:{color:"#4e83f7"}},ne={key:2,style:{color:"#55c31f"}},se={key:3,style:{color:"#d9d9d9"}},ae={class:"num"},le={class:"num"},oe={class:"order-time"},ce={key:2,class:"order"},ie={class:"title"},re={class:"num num2"},de={class:"num"},pe={class:"num"},me={class:"order-time"},ue={key:3,class:"order"},ye={class:"title"},ve={class:"type"},ge={class:"icon"},fe={class:"info"},he={key:0,style:{color:"#faad14","font-size":"12px","margin-left":"12px"}},xe={key:1,style:{color:"#52c41a","font-size":"12px","margin-left":"12px"}},ke={key:2,style:{color:"#ff4d4f","font-size":"12px","margin-left":"12px"}},be={class:"num num2"},we={class:"order-time"},Le={key:0,class:"read"},Ie={key:1,class:"noread"},Re=t({__name:"mesList",props:{client:{type:Object,default:()=>({})},chatList:{type:Array,default:()=>[]},slaveId:{type:Boolean||String}},setup(t){const L=t,I=w(),{$http:R}=I.appContext.config.globalProperties,Re=s(),_e=s(1);let Me=s();const je=s(0),Ae=s(!1);function He(){var e;void 0===Me.value&&0===(null==(e=Re.value)?void 0:e.scrollTop)&&(Me.value=function({client:e,page:t,chatList:n}){return R.get("/openapi/member/agent/withdraw/chat_record",{params:{page:t||1,limit:20,masterId:e.memberId}}).then((({data:t})=>(e.mesList=[...t.data.reduce(((t,n)=>(e.mesList.find((e=>e.msgId==n.msgId||n.mid&&e.mid==n.mid))||t.push(n),t)),[]).sort(((e,t)=>e.sendAt-t.sendAt>0?1:-1)).filter((e=>!(-1===e.senderRole&&1===e.receiverRole))),...e.mesList],t.data)))}({client:L.client,page:_e.value++,chatList:L.chatList}).then((async e=>{var t;if(e&&0!=e.length){let n=null==(t=e.find((e=>e.mid)))?void 0:t.mid;if(n){const e=document.querySelector(`[data-msg="${n}"]`);null==e||e.scrollIntoView()}Me.value=void 0,He()}else je.value===L.chatList.length-1?(Ae.value=!0,Me.value=!0):(Me.value=void 0,_e.value=1,L.chatList[++je.value]&&He())})).catch((e=>{_e.value--,Me.value=void 0})))}a((()=>{var e;null==(e=Re.value)||e.addEventListener("scroll",(function(e){He()})),Re.value.addEventListener("click",(function(e){if("IMG"===e.target.tagName){let t=document.createElement("div");t.style="position:fixed;width:100vw !important;height:100vh !important;top:0;left:0;z-index:99999999;max-width:none !important;object-fit: contain;background-color:rgb(36 36 36 / 50%);padding:15vh 15vw;box-sizing: border-box;display:flex;flex-direction:column;justify-content:center;text-align:right;align-items: center;",t.onclick=function(e){return e.stopPropagation(),!1};let n=document.createElement("span");n.innerText="×",n.style="color: white;font-size: 32px;position: fixed;top: 32px;right: 32px;cursor: pointer;padding: 8px;",n.addEventListener("click",(e=>{t.parentNode.removeChild(t)})),t.appendChild(n);let s=document.createElement("img");s.src=e.target.src,s.style="object-fit: contain;max-width: 70vw !important;max-height: 70vh;",t.appendChild(s),document.body.appendChild(t)}})),l((()=>L.client.id),(e=>{Me.value=void 0,_e.value=1,je.value=0,L.client.mesList=[],Ae.value=!1,e&&He()}),{immediate:!0})}));let Se=new Map;function Te(e){try{Se.get(e)||Se.set(e,JSON.parse(e))}catch{}return Se.get(e)||{}}return(s,a)=>{const l=e,w=o("icon"),L=c("loading");return i((d(),p("div",{class:"mes-box",ref_key:"box",ref:Re},[Ae.value?(d(),p("p",_,"无历史消息")):m("",!0),(d(!0),p(u,null,y(t.client.mesList,(e=>(d(),p("div",{class:v(["mes-item",1!==e.senderRole?"get":"send"]),"data-msg":e.mid},[7===e.category?(d(),p("div",j,[A,g("span",{style:{"vertical-align":"middle",color:"#666666","max-width":"60%"},innerHTML:e.content},null,8,H),S])):(d(),p(u,{key:1},[g("img",{onerror:"errorImg(this)",name:"avator",src:1!==e.senderRole?e.slaveHeadImg:e.masterHeadImg,class:"avatar"},null,8,T),g("div",null,[g("div",z,[g("span",C,[1===e.senderRole?(d(),p("span",E,f(r(n)(e.sendAt||e.attach.time)),1)):m("",!0),1!==e.senderRole?(d(),p("span",N,f(e.slaveUserName),1)):m("",!0)]),1===e.category?(d(),p("div",{key:0,innerHTML:e.content},null,8,F)):m("",!0),2===e.category?(d(),p("img",{key:1,src:e.content,alt:"",style:{"max-width":"250px"}},null,8,O)):m("",!0),3===e.category?(d(),p("video",{key:2,src:e.content,alt:"",style:{width:"250px"},controls:""},null,8,P)):m("",!0),4===e.category?(d(),p("video",{key:3,src:e.content,alt:"",style:{width:"250px"},controls:""},null,8,U)):m("",!0),5===e.category?(d(),p("video",{key:4,src:e.content,alt:"",style:{width:"250px"},controls:""},null,8,$)):m("",!0),6===e.category?(d(),p(u,{key:5},["withdrawChangeStatus"===Te(e.content).type?(d(),p("div",q,[g("p",null,[h(" 亲，您于"+f(r(n)(Te(e.content).statusAt))+"发起的 ",1),g("span",B,f(Te(e.content).amount||0),1),h("元 提现状态已更改为 ")]),300===Te(e.content).status||400===Te(e.content).status?(d(),p("p",G,[300===Te(e.content).status?(d(),p("span",J,"完成")):m("",!0),400===Te(e.content).status?(d(),p("span",Q,"关闭")):m("",!0)])):m("",!0),300!==Te(e.content).status&&400!==Te(e.content).status||!Te(e.content).because?m("",!0):(d(),p("p",V,[g("span",W,f(400===Te(e.content).status?"关闭原因":"摘要"),1),h(" ："),g("p",{innerHTML:Te(e.content).because},null,8,D)]))])):"withdraw"===Te(e.content).type?(d(),p("div",K,[g("p",X,f(1!==e.senderRole?"亲，请核对":"")+"提现信息",1),g("p",Y,"提现金额："+f(Te(e.content).amount),1),g("p",Z,[h("提现状态： "),100===Te(e.content).status?(d(),p("span",ee,"待受理")):200===Te(e.content).status?(d(),p("span",te,"处理中")):300===Te(e.content).status?(d(),p("span",ne,"已完成")):400===Te(e.content).status?(d(),p("span",se,"已关闭")):m("",!0)]),g("p",ae,"手续费："+f(Te(e.content).handleFee),1),g("p",le,"提现地址："+f(Te(e.content).address),1),g("p",oe," 创建时间："+f(r(n)(Te(e.content).statusAt)||"-"),1)])):"commission"===Te(e.content).type?(d(),p("div",ce,[g("p",ie,f(1!==e.senderRole?"亲，请核对":"")+"佣金信息",1),g("p",re,"订单号："+f(Te(e.content).orderNo),1),g("p",de,"充值账号："+f(Te(e.content).rechargeUsername),1),g("p",pe,"获得佣金："+f(Te(e.content).amount),1),g("p",me," 提成时间："+f(r(n)(Te(e.content).timeAt)||"-"),1)])):(d(),p("div",ue,[g("p",ye,f(1!==e.senderRole?"亲，请核对":"")+"订单信息",1),g("div",ve,[g("div",ge,[x(l,{color:"#4c83ff",name:"huangguan"})]),g("div",fe,[g("p",null,[h(f(Te(e.content).title)+" ",1),1===Te(e.content).payStatus?(d(),p("span",he,"待付款")):m("",!0),2===Te(e.content).payStatus?(d(),p("span",xe,"成功")):m("",!0),3===Te(e.content).payStatus?(d(),p("span",ke,"失败")):m("",!0)]),g("p",null,"合计：￥"+f(Te(e.content).amount),1)])]),g("p",be,"订单号："+f(Te(e.content).orderNo),1),g("p",we," 创建时间："+f(r(n)(Te(e.content).payAt)||"-"),1)]))],64)):m("",!0)])]),"fail"===e.sendStatus?(d(),k(w,{key:0,class:"err"},{default:b((()=>[x(l,{name:"WarningFilled",color:"#ff4d4f"})])),_:1})):e.mid?(d(),p(u,{key:1},[1===e.read?(d(),p("span",Le,"已读")):0===e.read?(d(),p("span",Ie,"未读")):m("",!0)],64)):m("",!0)],64))],10,M)))),256))])),[[L,r(Me)&&!0!==r(Me)]])}}},[["__scopeId","data-v-2ae9ec57"]]);export{Re as M};

import{_ as a}from"./index-b0450432.js";import{d as e,k as s,o as i,r as l,a6 as o,R as n,ba as t,bh as r,l as d,bf as c,Q as m,a1 as p,u as v,bb as u,bc as h,bk as b,bj as f,a4 as g,h as y,bd as k,be as x}from"./vendor-others-96825896.js";import{_ as I}from"./HeaderH5-49d0ad48.js";import{u as z}from"./vendor-vuex-61b6ee10.js";import{Z as _,T as j,$ as C,p as A,a6 as O,V as $,W as L,_ as w}from"./index-886f43d3.js";import{a as N}from"./vendor-axios-a0dbaeda.js";import{m as P,j as S,B as R}from"./vendor-ant-design-vue-7dd2b151.js";import"./vendor-vue-router-5605f985.js";const T=a=>(k("data-v-3fa719fe"),a=a(),x(),a),q={class:"content"},E={class:"info-box"},F=T((()=>c("label",null,"头像",-1))),G={class:"avator"},H=["src"],K=T((()=>c("label",null,"用户名",-1))),M={class:"avator"},U=T((()=>c("label",null,"昵称",-1))),B={class:"avator"},D=T((()=>c("label",null,"手机号",-1))),J={class:"avator"},Q=T((()=>c("label",null,"邮箱",-1))),V={class:"avator"},W=T((()=>c("label",null,"性别",-1))),Z={class:"avator"},X=T((()=>c("label",null,"生日",-1))),Y={class:"avator"},aa=T((()=>c("label",null,"地址",-1))),ea={class:"avator"},sa=T((()=>c("label",null,"签名",-1))),ia={class:"avator"},la={class:"info-box"},oa={class:"item-box"},na=T((()=>c("div",{class:"i_box-info"},[c("label",{class:"label"},"登录密码"),c("div",{style:{color:"#999"}},"密码长度为6~20个字符")],-1))),ta={key:0,class:"item-box"},ra={class:"i_box-info"},da=T((()=>c("label",{class:"label"},"手机号",-1))),ca={style:{color:"#999"}},ma={key:1,class:"item-box"},pa={class:"i_box-info"},va=T((()=>c("label",{class:"label"},"邮箱",-1))),ua={style:{color:"#999"}},ha=w(e({__name:"index",setup(e){const k=z(),x=s((()=>k.getters.allInfo)),w=y(),{$http:T}=w.appContext.config.globalProperties,ha=a=>!j("h5")&&((0!=a||1==ba.userInfo.editName)&&void("MemberAccountAddress"==a?O.push({name:"MemberAccountAddress"}):O.push({name:"accountUpdate",query:{id:a}})));i((()=>{document.title="账号设置",ba.loading=!0,T.get("/openapi/member/info").then((a=>{let{data:e}=a;k.commit("SETUSERINFO",e),ba.userInfo=e})).finally((()=>{ba.loading=!1}))}));const ba=l({userInfo:k.getters.userInfo||{},activeKey:1,loading:!1,headImgLoading:!1}),{userInfo:fa,activeKey:ga,loading:ya,headImgLoading:ka}=o(ba),xa=a=>{if(j("h5"))return!1;const e="image/jpeg"===a.type||"image/png"===a.type;return e||P.error("只支持JPG/PNG,建议尺寸为240*240!"),e},Ia=async a=>{ba.headImgLoading=!0;const e=a.file;let s=new FormData;s.append("file",e);try{var i={method:"POST",url:($.getSession("tplApi")||k.state.api)+"/openapi/upload",headers:{Authorization:L()},data:s};let a=await N(i);200==a.status?(P.success(a.data.message||"上传成功"),l="/"+a.data.path,T.put("/openapi/member/edit",{headImg:l}).then((a=>{location.reload()}))):P.error("上传失败"),ba.headImgLoading=!1}catch(o){ba.headImgLoading=!1}var l},za=()=>{if(j("click"))return!1};return(e,s)=>{const i=S,l=a,o=R,y=n("loading");return t(),r("div",null,[d(I,{title:"个人资料"}),c("div",q,[m(c("div",E,[c("div",{class:"item-info",onClick:za,style:{padding:"1rem 1rem 0.5rem"}},[F,v(ya)?b("",!0):(t(),u(i,{key:0,style:{width:"50px",height:"50px"},disabled:v(j)(),accept:".jpg,.jpeg,.png",class:"avatar-uploader","show-file-list":!1,customRequest:Ia,"before-upload":xa},{default:h((()=>[m((t(),r("div",G,[c("img",{src:v(_)(v(fa).headImg),name:"avator",onerror:"errorImg(this)"},null,8,H)])),[[y,v(ka)]])])),_:1},8,["disabled"]))]),c("div",{class:"item-info",onClick:s[0]||(s[0]=a=>ha(0))},[K,c("div",M,f(v(fa).name),1),1==v(fa).editName?(t(),u(l,{key:0,name:"zhankai",class:"rightIcon",size:"20px",color:"#999"})):b("",!0)]),c("div",{class:"item-info",onClick:s[1]||(s[1]=a=>ha(1))},[U,c("div",B,f(v(fa).nickname||"-"),1),d(l,{name:"zhankai",class:"rightIcon",size:"20px",color:"#999"})]),v(x).smsOpen?(t(),r("div",{key:0,class:"item-info",onClick:s[2]||(s[2]=a=>ha(7))},[D,c("div",J,f(v(fa).phone?v(fa).phone.replace(/^(\d{3})\d{4}(\d+)/,"$1****$2"):"未绑定"),1),d(l,{name:"zhankai",class:"rightIcon",size:"20px",color:"#999"})])):b("",!0),v(x).emailOpen?(t(),r("div",{key:1,class:"item-info",onClick:s[3]||(s[3]=a=>ha(8))},[Q,c("div",V,f(v(C)(v(fa).email)||"未绑定"),1),d(l,{name:"zhankai",class:"rightIcon",size:"20px",color:"#999"})])):b("",!0),c("div",{class:"item-info",onClick:s[4]||(s[4]=a=>ha(2))},[W,c("div",Z,f(["","男","女"][v(fa).sex]),1),d(l,{name:"zhankai",class:"rightIcon",size:"20px",color:"#999"})]),c("div",{class:"item-info",onClick:s[5]||(s[5]=a=>ha(3))},[X,c("div",Y,f(v(fa).birthday?v(A)(v(fa).birthday,"{y}-{m}-{d}"):"-"),1),d(l,{name:"zhankai",class:"rightIcon",size:"20px",color:"#999"})]),c("div",{class:"item-info",onClick:s[6]||(s[6]=a=>ha(4))},[aa,c("div",ea,f(v(fa).address||"-"),1),d(l,{name:"zhankai",class:"rightIcon",size:"20px",color:"#999"})]),c("div",{class:"item-info",onClick:s[7]||(s[7]=a=>ha(5))},[sa,c("div",ia,f(v(fa).desc||"-"),1),d(l,{name:"zhankai",class:"rightIcon",size:"20px",color:"#999"})])],512),[[p,1==v(ga)]]),m(c("div",la,[c("div",oa,[na,d(o,{type:"primary",class:"security-btns",onClick:s[8]||(s[8]=a=>ha(6))},{default:h((()=>[g("修改")])),_:1})]),v(x).smsOpen?(t(),r("div",ta,[c("div",ra,[da,c("div",ca,f(v(fa).phone?v(fa).phone.replace(/^(\d{3})\d{4}(\d+)/,"$1****$2"):"未绑定"),1)]),d(o,{type:"primary",class:"security-btns",onClick:s[9]||(s[9]=a=>ha(7))},{default:h((()=>[g(f(v(fa).phone?"修改":"去绑定"),1)])),_:1})])):b("",!0),v(x).emailOpen?(t(),r("div",ma,[c("div",pa,[va,c("div",ua,f(v(C)(v(fa).email)||"未绑定"),1)]),d(o,{type:"primary",class:"security-btns",onClick:s[10]||(s[10]=a=>ha(8))},{default:h((()=>[g(f(v(fa).phone?"修改":"去绑定"),1)])),_:1})])):b("",!0)],512),[[p,2==v(ga)]])])])}}}),[["__scopeId","data-v-3fa719fe"]]);export{ha as default};

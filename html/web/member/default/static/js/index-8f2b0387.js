import{_ as e}from"./index-b0450432.js";import{_ as a}from"./empty-ec21309c.js";import{h as t,f as l,v as s}from"./Footer-83a26624.js";import{_ as n,p as o,T as r}from"./index-886f43d3.js";import{s as d,L as u,F as c,W as p,A as g}from"./lunarFestival-711a6435.js";import{v,o as y,w as f,Z as m,ba as h,bh as b,bf as k,bj as x,a4 as D,F as C,bm as w,bo as _,bb as L,bk as j,h as S,bd as I,be as T,d as M,bc as z,l as R,r as F,k as A,a6 as P,u as G,a5 as K}from"./vendor-others-96825896.js";import{d as O,M as Y,m as N,l as U,B as $,b as W,c as B,e as q,k as E}from"./vendor-ant-design-vue-7dd2b151.js";import{u as H}from"./vendor-vuex-61b6ee10.js";import{u as Z}from"./vendor-vue-router-5605f985.js";import"./base-631089b1.js";import"./invite.vue_vue_type_style_index_0_lang-7e36a586.js";import"./gold-2bafa79e.js";import"./vendor-axios-a0dbaeda.js";const J="/memberUser/static/svg/gold-b1f7c72b.svg";function Q(e=new Date){return e=+(e=new Date(e))+864e5,(e=new Date(e)).getFullYear()+"-"+(e.getMonth()+1)+"-"+e.getDate()}function V(e=new Date){return e=+(e=new Date(e))-864e5,(e=new Date(e)).getFullYear()+"-"+(e.getMonth()+1)+"-"+e.getDate()}const X={class:"calendar-container"},ee={class:"select-box",style:{visibility:"visible"}},ae={style:{"font-size":"14px"}},te={class:"table-box"},le=(e=>(I("data-v-cf0b58ac"),e=e(),T(),e))((()=>k("tr",{style:{"text-align":"center"},class:"goldSignHead"},[k("th",null,"一"),k("th",null,"二"),k("th",null,"三"),k("th",null,"四"),k("th",null,"五"),k("th",{class:"table-box-weekend"},"六"),k("th",{class:"table-box-weekend"},"日")],-1))),se={class:"goldSingBody"},ne={key:"item.date"},ie={class:"calendar-relative"},oe=["date"],re={class:"item-box"},de={key:0},ue={class:"item-dayTime"},ce=n({__name:"index",props:{date:String,range:{type:Array,default:[2010,2030]}},emits:["change"],setup(a,{expose:t,emit:l}){const s=a,n=S(),{$http:i}=n.appContext.config.globalProperties,r=v(""),I=v([""]),T=v([]),M=v(""),z=v(""),R=v("2021");let F=v({}),A=new Date;F.value=d.solar2lunar(A.getFullYear(),A.getMonth()+1,A.getDate());for(let e=s.range[0];e<s.range[1];e++);const P=(new Date).getFullYear()+"-"+((new Date).getMonth()+1)+"-"+(new Date).getDate();const G=e=>{var a=r.value.split("-")[1];if(12!=a||e)if(1==a&&e){let e=Number(r.value.split("-")[0])-1;R.value=e,z.value=12,r.value=[e,12,r.value.split("-")[2]].join("-")}else a=e?Number(a)-1:Number(a)+1,z.value=a,r.value=[r.value.split("-")[0],a,r.value.split("-")[2]].join("-");else{let e=Number(r.value.split("-")[0])+1;R.value=e,z.value=1,r.value=[e,1,r.value.split("-")[2]].join("-")}N(`${R.value}${z.value}`),m($)},K=async()=>{U(),s.date&&(r.value=s.date),N(R.value,z.value)},O=v(0),Y=v(0),N=(e,a)=>{i.get("/openapi/sign/list").then((e=>{if(e.data.length<1)return T.value=[],!1;let a=e.data.list;O.value=e.data.accumulate,Y.value=e.data.continuous;let t=a.map((e=>o(e.signDate,"{y}-{m}-{d}")));T.value=t,$()}))},U=()=>{let e=new Date,a=e.getFullYear(),t=e.getMonth()+1,l=e.getDate();M.value=e,R.value=a,z.value=t,r.value=[a,t,l].join("-")},$=()=>{let e=R.value,a=z.value,t=1,l=[];let s=new Date([e,a,t].join("-")),n=[e,a,t].join("-"),i=s.getDay();i=0==i?7:i;for(let v=1;v<i;v++){n=V(new Date(n));let e,a,{term:t,dayCn:s,monthCn:i,cDay:v,cMonth:y,cYear:f}=d.solar2lunar(...n.split("-"));if(c[y]&&c[y][v]&&(t=c[y][v]),u[i]&&u[i][s]&&(t=u[i][s]),p[f]&&p[f][y]&&p[f][y][v]&&(e=!0),g[f]&&g[f][y]){let e=g[f][y];v>=e[0]&&v<=e[1]&&(a=!0)}l.push({day:n.split("-")[2],date:n,d_day:t||s,isLast:new Date(n)<new Date(P),ishover:r.value==n,isSelectClass:T.value.indexOf(o(n,"{y}-{m}-{d}"))>=0,otherMonth:!0,hasTerm:t,isWeekend:(6==new Date(n).getDay()||0==new Date(n).getDay())&&!e,isWorkDay:e,isRestDay:a})}n=[e,a,t].join("-"),l=l.reverse();for(let v=0;v<=42-i;v++){let e,t,{term:s,dayCn:i,monthCn:v,cMonth:y,cDay:f,cYear:m}=d.solar2lunar(...n.split("-"));if(c[y]&&c[y][f]&&(s=c[y][f]),u[v]&&u[v][i]&&(s=u[v][i]),p[m]&&p[m][y]&&p[m][y][f]&&(e=!0),g[m]&&g[m][y]){let e=g[m][y];f>=e[0]&&f<=e[1]&&(t=!0)}l.push({date:n,day:n.split("-")[2],d_day:s||i,isLast:new Date(n)<new Date(P),ishover:r.value==n,isSelectClass:T.value.indexOf(o(n,"{y}-{m}-{d}"))>=0,otherMonth:n.split("-")[1]!=a,hasTerm:s,isWeekend:(6==new Date(n).getDay()||0==new Date(n).getDay())&&!e,isWorkDay:e,isRestDay:t}),n=Q(new Date(n))}I.value=[];for(let o=0;o<=5;o++)I.value.push(l.splice(0,7))};t({init:K}),y((()=>{K()})),f(r,(e=>{R.value=e.split("-")[0],z.value=e.split("-")[1];let a=d.solar2lunar(...e.split("-"));F.value={lunarFestival:u[a.monthCn]?u[a.monthCn][a.dayCn]:void 0,festival:c[a.cMonth]?c[a.cMonth][a.cDay]:void 0,...a},l("change",{date:e,...F.value}),m($)}));const W=e=>{e.target.parentNode.getAttribute("date")?e.target.parentNode.getAttribute("date"):e.target.getAttribute("date")};return(a,t)=>{const l=e;return h(),b("div",X,[k("div",ee,[k("i",{onClick:t[0]||(t[0]=e=>G(!0))},x("<")),k("span",ae,[D("您已连续签到"),k("label",null,x(Y.value),1),D("天  累计签到 "),k("label",null,x(O.value),1),D("天")]),k("i",{onClick:t[1]||(t[1]=e=>G(!1))},x(">"))]),k("table",te,[k("tbody",null,[le,(h(!0),b(C,null,w(I.value,(e=>(h(),b("tr",se,[(h(!0),b(C,null,w(e,(e=>{return h(),b("td",ne,[k("div",ie,[k("a",{href:"javascript:void(0);",class:_({"item-selected":e.isSelectClass,"item-hover":e.ishover,"item-other-month":e.otherMonth,"item-last-nosign":e.isLast&&!e.isSelectClass}),date:e.date,onClick:W},[k("span",re,[e.isLast&&!e.isSelectClass?(h(),b("span",de,"已过")):e.isSelectClass?(h(),L(l,{key:1,name:"xuanzhong",color:e.isSelectClass&&e.ishover?"#fff":"#FFBD68",size:"16px"},null,8,["color"])):j("",!0),k("span",ue,x((a=e.date,a?P==a?"今天":o(a,"{m}-{d}"):"")),1)])],10,oe)])]);var a})),128))])))),256))])])])}}},[["__scopeId","data-v-cf0b58ac"]]),pe=M({__name:"rules",props:{visible:{type:Boolean,default:!1},taskRules:{type:Array,default:[{key:1,explain:"每天首次登录",gold:10},{key:2,explain:"新注册账号",gold:10},{key:3,explain:"连续签到3天",gold:20},{key:4,explain:"连续签到5天",gold:10},{key:5,explain:"连续签到7天",gold:20},{key:6,explain:"连续签到10天",gold:10},{key:7,explain:"连续签到15天",gold:30}]}},emits:["update:visible"],setup(e,{emit:a}){const t=()=>{a("update:visible",!1)};return(a,l)=>{const s=O,n=Y;return h(),L(n,{visible:e.visible,destroyOnClose:!0,centered:"",title:"签到规则",width:480,onOk:t,onCancel:t},{default:z((()=>[R(s,{columns:[{title:"说明",dataIndex:"explain",key:"explain",width:320},{title:"赠送",dataIndex:"gold"}],pagination:!1,scroll:{y:250},"data-source":e.taskRules},{bodyCell:z((({column:e,text:a,record:t})=>["name"===e.dataIndex?(h(),b(C,{key:0},[D(x(a.first)+" "+x(a.last),1)],64)):j("",!0),"gold"===e.dataIndex?(h(),b(C,{key:1},[D(x("gold"===t.giftType?"金币："+t.gold:"会员天数："+t.vipDays),1)],64)):j("",!0)])),_:1},8,["data-source"])])),_:1},8,["visible"])}}}),ge=e=>(I("data-v-2b9960c8"),e=e(),T(),e),ve={class:"container",ref:"containerRef"},ye={class:"surplus-box"},fe={class:"surplus-title"},me={class:"other-box"},he={class:"surplus",style:{"font-weight":"700"}},be=ge((()=>k("img",{src:J,alt:"","data-v-b3e4f383":"",style:{width:"24px",height:"24px","margin-left":"5px"}},null,-1))),ke={key:0,class:"calendar-box"},xe={class:"calendar"},De={class:"task-bg"},Ce=ge((()=>k("img",{src:"/memberUser/static/png/taskbg-f6c7315d.png",class:"bgbanner"},null,-1))),we=ge((()=>k("div",{class:"task-bg-info"},[k("span",{style:{"font-size":"28px"}},"签到领金币"),k("span",null,"连续签到获取更多金币奖励")],-1))),_e={class:"task-box"},Le=ge((()=>k("h2",null,"做任务赚金币",-1))),je={class:"item-task"},Se={class:"task-info"},Ie={style:{"font-size":"14px",color:"#333333","font-weight":"400"}},Te={style:{"font-weight":"400",margin:"0 4px",color:"#ff865c"}},Me={class:"desc",style:{"font-size":"12px",color:"#999999","font-weight":"400"}},ze={key:0,style:{padding:"80px 0"},class:"query-empty"},Re=[ge((()=>k("img",{src:a,alt:"空状态"},null,-1))),ge((()=>k("p",null,"暂无任务",-1)))],Fe={key:1,class:"exchange-box"},Ae={class:"icons",style:{width:"48px",height:"48px"}},Pe={class:"info",style:{"margin-left":"12px"}},Ge={style:{"font-size":"12px",color:"#b18f7c"}},Ke=ge((()=>k("div",{class:"gold-number"},null,-1))),Oe=ge((()=>k("img",{src:J,alt:"","data-v-b3e4f383":"",style:{width:"16px",height:"16px","margin-right":"5px"}},null,-1))),Ye={key:0,style:{padding:"80px 0",width:"100%"},class:"query-empty"},Ne=[ge((()=>k("img",{src:a,alt:"空状态"},null,-1))),ge((()=>k("p",null,"暂无兑换套餐",-1)))],Ue={key:2,class:"trade-box"},$e={class:"trade-box-filter"},We={key:0},Be={key:0,class:"my-pagination"},qe=n(M({__name:"index",setup(a){const n=H(),d=S(),{$http:u}=d.appContext.config.globalProperties,c=v(null),p=[{title:"操作",dataIndex:"remark"},{title:"金币",dataIndex:"number"},{title:"时间",dataIndex:"createAt",width:180}];Z();const g=(e,a)=>{I.currentPage=e,f.goldList()};y((()=>{f.rules(),f.task(),f.goldInfo()}));const f={pck(){u.get("/openapi/pck/all",{params:{type:3}}).then((e=>{let a=e.data?e.data.sort(((e,a)=>e.sort-a.sort)):[];I.pckList=a}))},rules(){u.get("/openapi/sign/tasklist").then((e=>{var a,t,l,s,n,o,r,d,u,c,p,g;let{data:v}=e,y=[];if(v.goldConfig&&((null==(a=v.goldConfig)?void 0:a.loginGetGoldOpen)&&y.push({explain:"每天首次登录",gold:null==(t=v.goldConfig)?void 0:t.loginGetGold,vipDays:null==(l=v.taskList[i])?void 0:l.vipDays,giftType:null==(s=v.taskList[i])?void 0:s.giftType}),(null==(n=v.goldConfig)?void 0:n.registerGetGoldOpen)&&y.push({explain:"新注册账号",gold:null==(o=v.goldConfig)?void 0:o.registerGetGold,vipDays:null==(r=v.taskList[i])?void 0:r.vipDays,giftType:null==(d=v.taskList[i])?void 0:d.giftType})),v.taskList)for(let i in v.taskList)y.push({explain:`连续签到${null==(u=v.taskList[i])?void 0:u.days}天`,gold:null==(c=v.taskList[i])?void 0:c.goldCoin,vipDays:null==(p=v.taskList[i])?void 0:p.vipDays,giftType:null==(g=v.taskList[i])?void 0:g.giftType});I.taskRules=y}))},task(){u.get("/openapi/task/list").then((e=>{I.task=e.data}))},goldList(e=!1){if(r())return!1;u.get("/openapi/gold/page",{params:{limit:I.pageSize,offset:e?0:I.pageSize*(I.currentPage-1),type:I.filter}}).then((e=>{I.total=e.data.total,I.goldList=e.data.list}))},goldInfo(){u.get("/openapi/gold/info").then((e=>{I.consumption=e.data.consumption||0}))}},m=()=>{if(r("click"))return!1;u.post("/openapi/sign").then((e=>{N.success(e.data.message||"签到成功！"),n.dispatch("refreshInfo"),c.value.init()}))},I=F({task:[],currentPage:1,pageSize:10,total:0,myMenuKey:1,visableRules:!1,visablePay:!1,filter:0,taskRules:[],goldList:[],userInfo:A((()=>n.getters.userInfo))||{},consumption:0,pckList:[]}),{myMenuKey:T,visableRules:M,filter:J,currentPage:Q,goldList:V,total:X,task:ee,consumption:ae,pckList:te,pageSize:le,visablePay:se,taskRules:ne,userInfo:ie}=P(I),oe=(e="account")=>{"agent"==e&&(I.menuType="agent",sessionStorage.setItem("menuType","agent")),"account"==e&&(I.menuType="account",sessionStorage.setItem("menuType","account"))},re=v();return(a,i)=>{var d;const v=E,y=U,S=$,F=e,A=W,P=B,H=O,Z=q;return h(),b(C,null,[R(t,{onChangeMenuKey:oe}),k("div",ve,[R(y,{activeKey:G(T),"onUpdate:activeKey":i[0]||(i[0]=e=>K(T)?T.value=e:null),onChange:i[1]||(i[1]=e=>(2==I.myMenuKey&&f.pck(),void(3==I.myMenuKey&&f.goldList()))),class:"login"},{default:z((()=>[(h(),L(v,{key:1,tab:"金币中心"})),(h(),L(v,{key:2,tab:"金币兑换中心"})),(h(),L(v,{key:3,tab:"金币交易明细"}))])),_:1},8,["activeKey"]),k("div",ye,[k("span",fe,[D("金币余额"),k("label",null,"您已累计消费金币"+x(G(ae))+"个",1)]),k("div",me,[k("span",he,[D(x(G(ie).goldCoin)+" ",1),be]),R(S,{type:"primary",class:"paybtn",onClick:i[2]||(i[2]=e=>re.value.open())},{default:z((()=>[D("立即购买")])),_:1})])]),1==G(T)?(h(),b("div",ke,[k("div",xe,[k("div",De,[Ce,we,R(S,{type:"primary",shape:"round",class:"taskbtns",disabled:G(ie).isSign,onClick:m},{default:z((()=>[D(x(G(ie).isSign?"已签到":"立即签到"),1)])),_:1},8,["disabled"]),k("div",{class:"rule-tags",onClick:i[3]||(i[3]=e=>M.value=!0)},"规则")]),R(ce,{ref_key:"calendars",ref:c},null,512)]),k("div",_e,[Le,(h(!0),b(C,null,w(G(ee),(e=>(h(),b("div",je,[k("div",Se,[k("div",Ie,[D(x(e.title)+" ",1),R(F,{name:"gold"}),k("span",Te,"+"+x(e.goldCoin),1)]),k("div",Me,x(e.info),1)]),R(S,{type:"primary",class:"task-btn",disabled:1!=e.state,onClick:i[4]||(i[4]=e=>(()=>{if(r("click"))return!1;window.location.href=location.origin})()),shape:"round"},{default:z((()=>[D(x(1==e.state?"去完成":"已完成"),1)])),_:2},1032,["disabled"])])))),256)),0==G(ee).length?(h(),b("div",ze,Re)):j("",!0)])])):j("",!0),2==G(T)?(h(),b("div",Fe,[(h(!0),b(C,null,w(G(te),(e=>(h(),b("div",{class:_(["item-exch",{moEvents:G(ie).goldCoin<e.price}])},[k("div",Ae,[R(F,{name:"huangguan",color:"#fff",size:"22px"})]),k("div",Pe,[k("span",null,[k("label",null,x(e.number),1),D("天")]),k("span",Ge,x(""!=e.description?e.description:"暂无描述"),1)]),Ke,R(S,{type:"primary",shape:"round",onClick:a=>(e=>{if(r("click"))return!1;Y.confirm({content:"是否兑换该套餐！",okText:"确定",cancelText:"取消",closable:!0,centered:!0,onOk:()=>new Promise(((a,t)=>{u.get(`/openapi/pck/exchange/${e}`).then((e=>{N.success(e.data||"兑换成功！"),n.dispatch("refreshInfo"),f.goldInfo(),setTimeout((()=>{Y.destroyAll()}),200)})).catch((e=>{N.error(e.data||"兑换失败！"),t(!1)}))})),onCancel(){Y.destroyAll()}})})(e.id),class:"exch-btn"},{default:z((()=>[Oe,D(" "+x(e.price)+"金币",1)])),_:2},1032,["onClick"])],2)))),256)),0==G(te).length?(h(),b("div",Ye,Ne)):j("",!0)])):j("",!0),3==G(T)?(h(),b("div",Ue,[k("div",$e,[R(P,{value:G(J),"onUpdate:value":i[5]||(i[5]=e=>K(J)?J.value=e:null),onChange:i[6]||(i[6]=e=>f.goldList(!0)),"button-style":"solid"},{default:z((()=>[R(A,{value:0},{default:z((()=>[D("全部")])),_:1}),R(A,{value:1},{default:z((()=>[D("充值")])),_:1}),R(A,{value:2},{default:z((()=>[D("赠送")])),_:1}),R(A,{value:3},{default:z((()=>[D("消费")])),_:1})])),_:1},8,["value"])]),R(H,{columns:p,scroll:{y:500},pagination:!1,"data-source":G(V)},{bodyCell:z((({column:e,record:a})=>["createAt"===e.dataIndex?(h(),b("span",We,x(G(o)(a.createAt)),1)):j("",!0)])),_:1},8,["data-source"]),(null==(d=G(V))?void 0:d.length)>0?(h(),b("div",Be,[R(Z,{current:G(Q),"onUpdate:current":i[7]||(i[7]=e=>K(Q)?Q.value=e:null),onChange:g,total:G(X),defaultPageSize:G(le),showSizeChanger:!1,"show-quick-jumper":""},null,8,["current","total","defaultPageSize"])])):j("",!0)])):j("",!0)],512),R(pe,{visible:G(M),"onUpdate:visible":i[8]||(i[8]=e=>K(M)?M.value=e:null),taskRules:G(ne)},null,8,["visible","taskRules"]),R(l),R(s,{ref_key:"vipRenewRef",ref:re,packageType:"gold"},null,512)],64)}}}),[["__scopeId","data-v-2b9960c8"]]);export{qe as default};

import{d as e,v as a,o as t,r as i,k as s,w as l,e as r,a6 as c,ba as d,bh as o,l as n,u as p,bf as v,F as u,bm as m,bo as y,a4 as g,bj as h,Q as b,bp as f,a5 as k,bk as P,bc as I,bb as x,a2 as T,h as C,bd as j,be as E}from"./vendor-others-96825896.js";import{_ as w}from"./gold-2bafa79e.js";import{_}from"./empty-ec21309c.js";import{Z as S,p as A,T as K,_ as R}from"./index-886f43d3.js";import{_ as G}from"./HeaderH5-49d0ad48.js";import{u as L}from"./vendor-vuex-61b6ee10.js";import{m as N,k as Y,l as U,R as O,c as V,B}from"./vendor-ant-design-vue-7dd2b151.js";import"./vendor-vue-router-5605f985.js";import"./vendor-axios-a0dbaeda.js";import"./index-b0450432.js";const D=e=>(j("data-v-53bf1e63"),e=e(),E(),e),H={class:"goldpay-content"},q={class:"payload"},z={key:0,class:"pay-content"},F={key:0},X={class:"pay-box"},Q=["onClick"],W={class:"gold-number"},Z=D((()=>v("img",{src:w,alt:""},null,-1))),$={class:"amount"},J={key:0},M=[D((()=>v("div",{class:"gold-numbers"},"自定义金额",-1)))],ee={key:1},ae={class:"gold-number"},te={key:1,class:"payload"},ie={class:"pay-box1"},se={class:"pay-vip-h5-head"},le=["src"],re={class:"head-text"},ce={class:"user-name"},de={class:"vip-end-date"},oe={class:"tab-head"},ne=["onClick"],pe=D((()=>v("img",{src:"/memberUser/static/svg/VIP-e6249a79.svg",alt:""},null,-1))),ve={key:0,class:"tab-body",style:{overflow:"hidden"}},ue={class:"cms-swiper-wrapper"},me=["onClick"],ye={key:0,class:"cms-swiper-preferential package-item"},ge={class:"preferential-bg"},he={class:"package-name"},be={class:"package-price"},fe={class:"preferential-footer"},ke={key:1,style:{overflow:"hidden"},class:"package-item"},Pe={class:"package-name"},Ie={class:"package-price"},xe={key:1,class:"package-info"},Te={class:"package-info-body"},Ce={key:2,class:"tab-body"},je=[D((()=>v("div",{style:{display:"flex","justify-content":"center","align-items":"center",width:"100%","flex-direction":"column"}},[v("img",{src:_,alt:"",style:{width:"100px",height:"100px"}}),v("p",{style:{"margin-top":"var(--cus-lig-margin)","font-size":"var(--cus-min-size)",color:"var(--cus-lig-fontcolor)"}}," 暂无套餐 ")],-1)))],Ee=D((()=>v("div",{style:{width:"94%",height:"1px","background-color":"#f1f1f1",margin:"0 auto"},class:"vipline"},null,-1))),we={key:2,style:{width:"185px",margin:"0 auto","text-align":"center",color:"#999"}},_e=[D((()=>v("img",{src:_,alt:"空状态"},null,-1))),D((()=>v("p",null,"暂无VIP套餐",-1)))],Se={key:3,style:{width:"185px",margin:"0 auto","text-align":"center",color:"#999"}},Ae=[D((()=>v("img",{src:_,alt:"空状态"},null,-1))),D((()=>v("p",null,"暂无金币套餐",-1)))],Ke={key:4,class:"paybtns"},Re=["src"],Ge={class:"gobtn"},Le=R(e({__name:"pay",emits:["update:visible"],setup(e,{emit:j}){const E=a(null),w=a(null),_=C(),{$http:R}=_.appContext.config.globalProperties,D=L(),Le=a(null),Ne={changePrice(){Oe.rechargePrice=Oe.rechargePrice.replace(/[^\d]/g,"");let e=Oe.payRate.gold/Oe.payRate.price;Oe.rechargeGold=Oe.rechargePrice*e},cancel(){R.post(1==Oe.typeIndex?"/openapi/pay/wechat/close_order":"/openapi/pay/ant/close_order",{orderId:Oe.orderId}).then((e=>{Oe.isCurrPay={},Oe.myIsPay=!1,clearInterval(Oe.timer)})).catch((()=>{N.error("取消订单失败！")}))},checkPay(e){Oe.activeKey=e,0==e?setTimeout((()=>{Le.value.focus()}),100):(He.value="",qe.value=0),Oe.isCurrPay=Oe.pckList.filter((e=>e.id==Oe.activeKey))[0]||{price:100*Oe.rechargePrice}}};t((()=>{(()=>{let e=document.getElementById("payTags");null===e&&(e=document.createElement("script"),e.src="/staticjs/qrious.js",e.id="payTags",document.getElementsByTagName("head")[0].appendChild(e))})(),Ue(),Ye(),document.title="支付"})),a(null);const Ye=()=>{R.get("/openapi/siteConfig/pay").then((e=>{let{data:a}=e;Oe.isPayObj=a}))},Ue=()=>{R.get("/openapi/pck/all",{params:{type:"gold"==Oe.type?2:1}}).then((e=>{var a;let t=e.data?e.data.sort(((e,a)=>e.sort-a.sort)):[];Oe.pckList=t,E.value=null==(a=t.find((e=>""!==e.name)))?void 0:a.id,Oe.activeKey=D.state.payIndex||t[0].id})),"gold"==Oe.type&&R.get("/openapi/siteConfig/goldRate").then((e=>{let{data:a}=e;Oe.payRate=a}))},Oe=i({activeKey:0,pckList:[],visible:!1,type:s((()=>D.getters.payType))||"gold",isCurrPay:{},orderId:"",timer:null,typeIndex:0,iframeUrl:"",myIsPay:!1,myCustomPrice:0,payRate:{},rechargePrice:"",rechargeGold:0,loading:!1,isPayObj:{}});l((()=>Oe.orderId),(e=>{e&&(Oe.timer=setInterval((()=>{if(Oe.loading)return!1;R.post("/openapi/pay/order/status",{orderId:Oe.orderId}).then((e=>{let{data:a}=e;a&&(N.success("支付成功！"),D.dispatch("refreshInfo"),Fe())}))}),1500))})),r((()=>{clearInterval(Oe.timer)}));const{activeKey:Ve,pckList:Be,type:De,rechargePrice:He,rechargeGold:qe,myIsPay:ze}=c(Oe),Fe=()=>{j("update:visible",!1),D.commit("SETISPAY",!1),Oe.isCurrPay={},Oe.activeKey=0,Oe.myIsPay=!1,D.commit("SETPAYINDEX",0),clearInterval(Oe.timer)},Xe=a(),Qe=D.state.userInfo,We=a(0);D.getters.vipPackage?Xe.value=D.getters.vipPackage:R.get("/openapi/pck/group/all").then((e=>{D.commit("SETVIPPACKAGE",e.data),Xe.value=e.data}));const Ze=a({}),$e=a(0);return(e,a)=>{var t;const i=Y,s=U,l=O,r=V,c=B;return d(),o("div",H,[n(G,{title:"gold"==p(De)?"购买金币":"充值会员"},null,8,["title"]),v("div",q,[p(ze)?P("",!0):(d(),o("div",z,["gold"==p(De)?(d(),o("div",F,[v("div",X,[(d(!0),o(u,null,m(p(Be),((e,a)=>(d(),o("div",{key:a,onClick:a=>Ne.checkPay(e.id),class:y({"item-pay-box":!0,active:e.id==p(Ve)})},[v("div",W,[Z,g(" "+h(e.number),1)]),v("div",$,"¥"+h((e.price/100).toFixed(2)),1)],10,Q)))),128)),Oe.payRate.switch?(d(),o("div",{key:0,style:{width:"426px"},onClick:a[2]||(a[2]=e=>Ne.checkPay(0)),class:y({"item-pay-box":!0,active:0==p(Ve)})},[0!=p(Ve)?(d(),o("div",J,M)):(d(),o("div",ee,[v("div",ae,h(p(qe))+"金币",1),b(v("input",{class:"amount",onInput:a[0]||(a[0]=(...e)=>Ne.changePrice&&Ne.changePrice(...e)),"onUpdate:modelValue":a[1]||(a[1]=e=>k(He)?He.value=e:null),placeholder:"¥0.00",type:"text",ref_key:"inputRef",ref:Le},null,544),[[f,p(He)]])]))],2)):P("",!0)])])):P("",!0),"vip"==p(De)?(d(),o("div",te,[v("div",ie,[v("div",se,[v("img",{src:p(S)(p(Qe).headImg),name:"avator",class:"cover",onerror:"errorImg(this)"},null,8,le),v("div",re,[v("div",ce,h(p(Qe).name),1),v("div",de,h(null==(t=p(Qe))?void 0:t.memberGroupName)+" "+h(p(Qe).expireTime&&2==p(Qe).group?"将在"+p(A)(1e3*p(Qe).expireTime,"{y}-{m}-{d}")+"到期":"开通VIP看大片"),1)])]),n(s,{activeKey:We.value,"onUpdate:activeKey":a[3]||(a[3]=e=>We.value=e),type:"card"},{renderTabBar:I((()=>[v("div",oe,[(d(!0),o(u,null,m(Xe.value,((e,a)=>(d(),o("div",{class:y(["tab-head-item",{"activeTab activeTab-left":a==We.value}]),onClick:e=>((e,a)=>{var t;We.value=a,$e.value=0,Oe.isCurrPay.id=null==(t=Xe.value[a])?void 0:t.list[0].id,document.querySelectorAll(".tab-head-item").forEach((e=>{e.classList.remove("activeTab-left","activeTab-center","activeTab-right")})),0==a?e.target.classList.add("activeTab-left"):1==a?e.target.classList.add("activeTab-center"):2==a&&e.target.classList.add("activeTab-right")})(e,a)},[pe,g(" "+h(e.memberGroupName.length>4?e.memberGroupName.slice(0,4)+"...":e.memberGroupName),1)],10,ne)))),256))])])),default:I((()=>[(d(!0),o(u,null,m(Xe.value,((e,a)=>(d(),x(i,{key:a},{default:I((()=>{var a,t;return[(null==(a=null==e?void 0:e.list)?void 0:a.length)>0?(d(),o("div",ve,[v("div",ue,[(d(!0),o(u,null,m(e.list,((e,a)=>(d(),o("div",{class:y(["swiper-slide tab-pane-item",{"active-package":a===$e.value}]),onClick:T((t=>((e,a,t)=>{$e.value=t,Object.keys(e).forEach((a=>{Ze.value[a]=e[a]})),Oe.isCurrPay=Ze.value})(e,0,a)),["stop"])},[""!=e.discountDesc?(d(),o("div",ye,[v("div",ge,[v("div",he,h(null==e?void 0:e.description),1),v("div",be," ¥"+h(e.price/100),1)]),v("div",fe,h(e.discountDesc),1)])):(d(),o("div",ke,[v("div",Pe,h(e.description),1),v("div",Ie," ¥"+h(e.price/100),1)]))],10,me)))),256))])])):P("",!0),(null==(t=null==e?void 0:e.list)?void 0:t.length)>0?(d(),o("div",xe,[v("div",Te,h(null==e?void 0:e.description),1)])):(d(),o("div",Ce,je))]})),_:2},1024)))),128))])),_:1},8,["activeKey"])]),Ee])):P("",!0),"vip"==p(De)&&0==Xe.value.length?(d(),o("div",we,_e)):P("",!0),"gold"!=p(De)||0!=p(Be).length||Oe.payRate.switch?P("",!0):(d(),o("div",Se,Ae)),p(Be).length>0?(d(),o("div",Ke,[n(r,{value:w.value,"onUpdate:value":a[4]||(a[4]=e=>w.value=e)},{default:I((()=>[(d(!0),o(u,null,m(Oe.isPayObj.paySupport,(e=>(d(),x(l,{value:e.addr},{default:I((()=>[v("img",{src:e.icon,alt:""},null,8,Re),g(" "+h(e.name),1)])),_:2},1032,["value"])))),256))])),_:1},8,["value"])])):P("",!0),v("div",Ge,[n(c,{type:"primary",onClick:a[5]||(a[5]=e=>(e=>{if(K("h5"))return!1;if(!w.value)return N.success("请选择支付方式");const a=Oe.isPayObj.paySupport.find((a=>a.addr===e));0!=Oe.activeKey||0!=He.value?(He.value&&0==Oe.activeKey&&D.commit("SETRECHAR",He.value),D.commit("SETH5PAYURL","gold"==Oe.type?"/gold":"/order"),D.commit("SETPAYINDEX",null==Oe?void 0:Oe.isCurrPay.id),D.commit("SETISPAYING",!0),D.commit("SETISPAY",!1),D.commit("SETPAYWAY",a)):N.success("请输入充值金额")})(w.value||Ze.value.id))},{default:I((()=>[g("立即支付")])),_:1})])]))])])}}}),[["__scopeId","data-v-53bf1e63"]]);export{Le as default};

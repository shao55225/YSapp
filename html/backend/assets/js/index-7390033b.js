import{E as j,b as J,c as O,d as K,f as Q,g as X,h as N,F as Y,G as ee,i as T,j as L,k as G,v as M,_ as R,T as le,o as ae,C as oe,m as ue}from"./entry-9cc5c370.js";/* empty css                        */import{p as te}from"./plugHeader-c50619f4.js";import{e as se,a as ne,i as re,b as de,c as ie,p as pe,d as me}from"./player-03be9a9f.js";import{P as ce}from"./pagination-db6078c7.js";import{a as fe}from"./repository-d7a349f9.js";import{G as I,a as B,Z as D,z as H,e as ge,m as C,U as l,S as u,u as S,l as _,a6 as f,L as P,P as z,af as _e,R as k,O as U,d as be,p as x,W as he}from"./vue-11eabec3.js";import{E as ve,g as Fe}from"./el-upload-e1a152a0.js";/* empty css                      */import"./index-971e6ee4.js";/* empty css                                                                   */const Ee=I({__name:"editor",emits:["load"],setup($,{expose:b,emit:d}){const h=B(),e=D({code:"",id:0,introduce:"",name:"",sort:0,status:1,tag:"",type:"web",parseMod:0,parseAddress:"",jsonParseColumn:"url",jsonServer:"",logo:"",backgroundImg:""}),t=D({loading:!1,visible:!1,other:void 0,options:[]}),i=H("debounce")(m=>{!m||m.validate(o=>{if(o){t.loading=!0;let s=e.parseMod==1?`<iframe height=100% width=100% src='${e.parseAddress}{{Iyplayer.file}}' title='{{Iyplayer.name}}' frameborder=0 allowfullscreen=true></iframe>`:e.parseMod==3?e.parseAddress:"";(e.id?se({...e,parseAddress:s}):ne({...e,id:void 0,parseAddress:s})).then(()=>{var a;j({position:"bottom-right",type:"success",message:(a=t.other)!=null&&a.id?"\u64AD\u653E\u5668\u66F4\u65B0\u6210\u529F":"\u64AD\u653E\u5668\u65B0\u589E\u6210\u529F"}),d("load"),n()}).finally(()=>{t.loading=!1})}})},300),n=()=>{t.other=void 0,t.visible=!1,e.parseMod=0,e.parseAddress="",e.jsonParseColumn="url",e.jsonServer=""},g={name:{required:!0,message:"\u8BF7\u8F93\u5165\u540D\u79F0",trigger:"blur"},tags:{required:!0,message:"\u8BF7\u8F93\u5165\u6807\u8BC6",trigger:"blur"},type:{required:!0,message:"\u8BF7\u9009\u62E9\u7C7B\u578B",trigger:"blur"},code:{required:!0,message:"\u8BF7\u8F93\u5165\u4EE3\u7801",trigger:"blur"}};function c(){var m,o;Object.keys(e).forEach(s=>{var a;e[s]=((a=t.other)==null?void 0:a[s])||e[s]}),t.other.parseMod==1&&((m=t.other.parseAddress)==null||m.replace(/<iframe [^>]*src=['"]([^'"]+)[^>]*>/gi,function(s,a){let p=a.indexOf("{{Iyplayer.file}}");e.parseAddress=a.substr(0,p)})),e.id=(o=t.other)==null?void 0:o.id,fe({page:1,limit:999}).then(s=>{var p,F,V;let a=(F=(p=s.list)==null?void 0:p.map(y=>y.tags))==null?void 0:F.join(",");t.options=Array.from(new Set(a.split(",").filter(y=>y))),(V=t.other)!=null&&V.id&&(e.tag=t.other.tag)})}b({open(m){var o;(o=h.value)==null||o.resetFields(),t.visible=!0,t.other=m}});const v=ge(()=>{var m;return(m=t.other)!=null&&m.id?"\u7F16\u8F91\u64AD\u653E\u5668":"\u65B0\u589E\u64AD\u653E\u5668"});return(m,o)=>{const s=J,a=O,p=K,F=Q,V=X,y=N,A=Y,E=ee,w=T,q=L,W=G,Z=M;return _(),C("div",null,[l(W,{"model-value":t.visible,"show-close":!t.loading,"close-on-press-escape":!1,title:S(v),width:500,"z-index":20,"close-on-click-modal":!1,onClose:n,onOpened:c},{footer:u(()=>[l(q,{class:"ml-auto",size:"small",loading:t.loading,onClick:n},{default:u(()=>[f(" \u53D6\u6D88 ")]),_:1},8,["loading"]),l(q,{size:"small",loading:t.loading,type:"primary",class:"border-0 bg-orange group-hover:bg-orangeLight",onClick:o[11]||(o[11]=r=>S(i)(h.value))},{default:u(()=>[f(" \u4FDD\u5B58 ")]),_:1},8,["loading"])]),default:u(()=>[P((_(),C("div",null,[l(w,{ref_key:"ruleFormRef",ref:h,"label-width":"85px",model:e,rules:g,"hide-required-asterisk":!1},{default:u(()=>[l(a,{label:"\u540D\u79F0",prop:"name"},{default:u(()=>[l(s,{spellcheck:"false",modelValue:e.name,"onUpdate:modelValue":o[0]||(o[0]=r=>e.name=r),modelModifiers:{trim:!0},clearable:"",class:"input",placeholder:"\u8BF7\u8F93\u5165\u540D\u79F0"},null,8,["modelValue"])]),_:1}),l(a,{label:"\u8D44\u6E90\u6807\u8BC6",prop:"tag"},{default:u(()=>[l(F,{modelValue:e.tag,"onUpdate:modelValue":o[1]||(o[1]=r=>e.tag=r),filterable:"","allow-create":"","default-first-option":"","reserve-keyword":!1,"fit-input-width":!0,style:{width:"100%"},placeholder:"\u8BF7\u8F93\u5165\u6216\u9009\u62E9\u8D44\u6E90\u6807\u8BC6"},{default:u(()=>[(_(!0),C(z,null,_e(t.options,r=>(_(),k(p,{key:r,label:r||"-",value:r},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1}),l(a,{label:"\u5E8F\u53F7",prop:"sort"},{default:u(()=>[l(V,{spellcheck:"false",modelValue:e.sort,"onUpdate:modelValue":o[2]||(o[2]=r=>e.sort=r),modelModifiers:{number:!0},clearable:"",precision:0,"step-strictly":"",min:1,"controls-position":"right",placeholder:"\u8BF7\u8F93\u5165\u5E8F\u53F7"},null,8,["modelValue"])]),_:1}),l(a,{label:"\u4ECB\u7ECD",prop:"introduce"},{default:u(()=>[l(s,{spellcheck:"false",modelValue:e.introduce,"onUpdate:modelValue":o[3]||(o[3]=r=>e.introduce=r),modelModifiers:{trim:!0},clearable:"",class:"input",placeholder:"\u8BF7\u8F93\u5165\u4ECB\u7ECD"},null,8,["modelValue"])]),_:1}),l(a,{label:"\u72B6\u6001",prop:"state"},{default:u(()=>[l(y,{modelValue:e.status,"onUpdate:modelValue":o[4]||(o[4]=r=>e.status=r),"active-value":1,"inactive-value":2},null,8,["modelValue"])]),_:1}),l(a,{label:"\u6A21\u5F0F",prop:"useParse"},{default:u(()=>[l(E,{modelValue:e.parseMod,"onUpdate:modelValue":o[5]||(o[5]=r=>e.parseMod=r),size:"small"},{default:u(()=>[l(A,{label:0},{default:u(()=>[f(" \u9ED8\u8BA4 ")]),_:1}),l(A,{label:1},{default:u(()=>[f(" \u64AD\u653E\u5668\u6A21\u5F0F ")]),_:1}),l(A,{label:2},{default:u(()=>[f(" \u9AD8\u7EA7\u6A21\u5F0F ")]),_:1}),l(A,{label:3},{default:u(()=>[f(" json\u89E3\u6790 ")]),_:1})]),_:1},8,["modelValue"])]),_:1}),e.parseMod==3?(_(),C(z,{key:0},[l(a,{label:"\u64AD\u653E\u5668\u5730\u5740"},{default:u(()=>[l(s,{spellcheck:"false",modelValue:e.parseAddress,"onUpdate:modelValue":o[6]||(o[6]=r=>e.parseAddress=r),modelModifiers:{trim:!0},clearable:"",class:"input",placeholder:"http://bofangqi.abc/index.html?uri="},null,8,["modelValue"])]),_:1}),l(a,{label:"\u89E3\u6790\u63A5\u53E3",prop:"jsonServer",rules:[{required:!0,message:"\u8BF7\u8F93\u5165\u89E3\u6790\u63A5\u53E3",trigger:"blur"}]},{default:u(()=>[l(s,{spellcheck:"false",modelValue:e.jsonServer,"onUpdate:modelValue":o[7]||(o[7]=r=>e.jsonServer=r),modelModifiers:{trim:!0},clearable:"",class:"input",placeholder:"\u8BF7\u8F93\u5165\u89E3\u6790\u63A5\u53E3"},null,8,["modelValue"])]),_:1}),l(a,{label:"\u5B57\u6BB5\u540D\u79F0",prop:"jsonParseColumn",rules:[{required:!0,message:"\u8BF7\u8F93\u5165\u5B57\u6BB5\u540D\u79F0",trigger:"blur"}]},{default:u(()=>[l(s,{spellcheck:"false",modelValue:e.jsonParseColumn,"onUpdate:modelValue":o[8]||(o[8]=r=>e.jsonParseColumn=r),modelModifiers:{trim:!0},clearable:"",class:"input",placeholder:"\u8BF7\u8F93\u5165\u5B57\u6BB5\u540D\u79F0"},null,8,["modelValue"])]),_:1})],64)):U("",!0),e.parseMod==1?(_(),k(a,{key:1,label:"\u64AD\u653E\u5668\u5730\u5740",prop:"parseAddress",rules:[{required:!0,message:"\u8BF7\u8F93\u5165\u64AD\u653E\u5668\u5730\u5740",trigger:"blur"}]},{default:u(()=>[l(s,{spellcheck:"false",modelValue:e.parseAddress,"onUpdate:modelValue":o[9]||(o[9]=r=>e.parseAddress=r),modelModifiers:{trim:!0},clearable:"",class:"input",placeholder:"http://bofangqi.abc/index.html?uri="},null,8,["modelValue"])]),_:1})):U("",!0),e.parseMod==2?(_(),k(a,{key:2,label:"\u4EE3\u7801",prop:"code"},{default:u(()=>[l(s,{spellcheck:"false",modelValue:e.code,"onUpdate:modelValue":o[10]||(o[10]=r=>e.code=r),rows:7,type:"textarea",placeholder:"\u8BF7\u8F93\u5165\u4EE3\u7801"},null,8,["modelValue"])]),_:1})):U("",!0)]),_:1},8,["model"])])),[[Z,t.loading]])]),_:1},8,["model-value","show-close","title"])])}}});const ye=R(Ee,[["__scopeId","data-v-73c4daaf"]]),Be=I({__name:"uploadPlayer",emits:["load"],setup($,{expose:b,emit:d}){const h=B(),e=D({file:void 0}),t=D({loading:!1,visible:!1}),i=H("debounce")(o=>{!o||o.validate(s=>{if(s){t.loading=!0;const a=new FormData;e.file.raw&&a.append("file",e.file.raw),re(a).then(()=>{j({position:"bottom-right",type:"success",message:"\u64AD\u653E\u5668\u5BFC\u5165\u6210\u529F"}),d("load"),n()}).finally(()=>{t.loading=!1})}})},300),n=()=>{t.visible=!1},g={file:{required:!0,message:"\u8BF7\u9009\u62E9\u6587\u4EF6",trigger:"blur"}},c=B(),v=o=>{c.value.clearFiles();const s=o[0];s.uid=Fe(),c.value.handleStart(s)};b({open(){var o;(o=h.value)==null||o.resetFields(),t.visible=!0}});const m="\u5BFC\u5165\u64AD\u653E\u5668";return(o,s)=>{const a=L,p=ve,F=O,V=T,y=G,A=M;return _(),C("div",null,[l(y,{"model-value":t.visible,"show-close":!t.loading,"close-on-press-escape":!1,title:m,width:450,"z-index":20,"close-on-click-modal":!1,onClose:n},{footer:u(()=>[l(a,{class:"ml-auto",size:"small",loading:t.loading,onClick:n},{default:u(()=>[f(" \u53D6\u6D88 ")]),_:1},8,["loading"]),l(a,{size:"small",loading:t.loading,type:"primary",class:"border-0 bg-orange group-hover:bg-orangeLight",onClick:s[1]||(s[1]=E=>S(i)(h.value))},{default:u(()=>[f(" \u4FDD\u5B58 ")]),_:1},8,["loading"])]),default:u(()=>[P((_(),C("div",null,[l(V,{ref_key:"ruleFormRef",ref:h,"label-width":"0",model:e,rules:g,"hide-required-asterisk":!1},{default:u(()=>[l(F,{label:"",prop:"file"},{default:u(()=>[t.visible?(_(),k(p,{key:0,ref_key:"upload",ref:c,accept:".json","auto-upload":!1,limit:1,"on-exceed":v,"on-remove":()=>e.file=void 0,"onUpdate:fileList":s[0]||(s[0]=E=>{var w;if(!((w=E[E.length-1])!=null&&w.raw.type.includes("json")))return S(j)({position:"bottom-right",type:"error",message:"\u53EA\u652F\u6301json\u683C\u5F0F\u7684\u6587\u4EF6"}),E.length=0,!1;e.file=E.length>0?E[0]:void 0})},{trigger:u(()=>[l(a,{type:"primary"},{default:u(()=>[f(" \u70B9\u51FB\u4E0A\u4F20 ")]),_:1})]),default:u(()=>[l(a,{class:"ml-3",link:"",style:{"padding-left":"12px",color:"#aeaeae"}},{default:u(()=>[f(" \u63D0\u793A\uFF1A\u53EA\u652F\u6301json\u6587\u4EF6 ")]),_:1})]),_:1},8,["on-remove"])):U("",!0)]),_:1})]),_:1},8,["model"])])),[[A,t.loading]])]),_:1},8,["model-value","show-close"])])}}});const Ce=R(Be,[["__scopeId","data-v-0cb9e59e"]]),Ve={class:"flex-y box",style:{padding:"24px"}},Ae={class:"flex-x-between"},ke={class:"search m-0"},De=I({__name:"index",setup($){B(!1);const b=B({pageIndex:1,pageSize:20,total:0}),d=D({loading:!1,data:[],searchVal:{keywords:"",order:""},selectList:[],load(i){b.value=i||b.value,d.loading=!0,de({page:b.value.pageIndex,limit:b.value.pageSize,...d.searchVal}).then(n=>{d.data=n.list,b.value.total=n.total}).finally(()=>{d.loading=!1})},handleSelectionChange(i){this.selectList=i},sortChnage({column:i,prop:n,order:g}){g?d.searchVal.order=`${n} ${g==="ascending"?"asc":"desc"}`:d.searchVal.order="",d.load()}}),h=B(),e=B(),t={statusChange(i,n){n.loading=!0,ie(n.id,i).then(()=>{j({position:"bottom-right",type:"success",message:"\u72B6\u6001\u66F4\u65B0\u6210\u529F"})}).catch(()=>{n.status=i===1?2:1}).finally(()=>{n.loading=!1})},del:i=>oe({message:"\u786E\u5B9A\u8981\u5220\u9664\u5417\uFF1F",okEms:"\u64AD\u653E\u5668\u5220\u9664\u6210\u529F"},()=>me(i.id).then(n=>(d.load(),n))),exportfn(i){pe(i.id).then(n=>{let g=(window.URL||window.webkitURL).createObjectURL(new Blob([n],{type:"application/json;charset=utf-8"})),c=document.createElement("a");c.download=i.name||"defaultPlayer",c.style.display="none",c.href=g,document.body.appendChild(c),c.click(),URL.revokeObjectURL(g),document.body.removeChild(c)})}};return be(()=>{d.load()}),(i,n)=>{const g=L,c=le,v=ue,m=N,o=ae,s=M;return _(),C("div",Ve,[l(te,null,{default:u(()=>[f("\u64AD\u653E\u5668\u7BA1\u7406")]),_:1}),x("div",Ae,[x("div",null,[l(g,{type:"primary",onClick:n[0]||(n[0]=a=>{var p;return(p=h.value)==null?void 0:p.open({})})},{default:u(()=>[f(" \u65B0\u589E\u64AD\u653E\u5668 ")]),_:1})]),x("div",ke,[l(c,{modelValue:d.searchVal.keywords,"onUpdate:modelValue":n[1]||(n[1]=a=>d.searchVal.keywords=a),onBlur:n[2]||(n[2]=a=>{b.value.pageIndex=1,d.load()})},null,8,["modelValue"])])]),P((_(),k(o,{data:d.data,class:"auto",stripe:!0,onSortChange:d.sortChnage,onSelectionChange:d.handleSelectionChange},{default:u(()=>[l(v,{prop:"sort",label:"\u663E\u793A\u987A\u5E8F","min-width":"80"}),l(v,{prop:"name",label:"\u64AD\u653E\u5668\u540D\u79F0","min-width":"150"}),l(v,{prop:"tag",label:"\u8D44\u6E90\u6807\u8BC6","min-width":"100"},{default:u(({row:a})=>[x("span",null,he(a.tag),1)]),_:1}),l(v,{prop:"status",label:"\u72B6\u6001"},{default:u(({row:a})=>[l(m,{modelValue:a.status,"onUpdate:modelValue":p=>a.status=p,"active-value":1,"inactive-value":2,loading:a.loading,onChange:p=>t.statusChange(p,a)},null,8,["modelValue","onUpdate:modelValue","loading","onChange"])]),_:1}),l(v,{prop:"introduce",label:"\u4ECB\u7ECD","min-width":"200","show-overflow-tooltip":!0}),l(v,{fixed:"right",label:"\u64CD\u4F5C",align:"right","min-width":"110"},{default:u(({row:a})=>[l(g,{type:"primary",link:"",onClick:p=>{var F;return(F=h.value)==null?void 0:F.open(a)}},{default:u(()=>[f(" \u7F16\u8F91 ")]),_:2},1032,["onClick"]),l(g,{type:"danger",link:"",onClick:p=>t.del(a)},{default:u(()=>[f(" \u5220\u9664 ")]),_:2},1032,["onClick"])]),_:1})]),_:1},8,["data","onSortChange","onSelectionChange"])),[[s,d.loading]]),l(ce,{pageinfo:b.value,onChange:d.load},null,8,["pageinfo","onChange"]),l(ye,{ref_key:"editorRef",ref:h,onLoad:d.load},null,8,["onLoad"]),l(Ce,{ref_key:"uploadPlayerRef",ref:e,onLoad:d.load},null,8,["onLoad"])])}}});const qe=R(De,[["__scopeId","data-v-b8118dcc"]]);export{qe as default};

import{_ as G,E as H,j as W,cP as Z,G as J,b as O,c as Q,i as X,v as Y,C as ee,o as ae,m as oe}from"./entry-9cc5c370.js";/* empty css                        */import{a as le,s as te,D as se,b as ne,E as de,c as ie,F as re,_ as me,G as pe}from"./databaseInfo-fa5b31e0.js";import{a as u,Z as w,z as ue,m as b,u as e,L as R,U as a,S as t,p as f,R as q,P as A,as as fe,l as p,a6 as m,W as T,af as ce,ap as _e,aq as be}from"./vue-11eabec3.js";import{p as ge}from"./plugHeader-c50619f4.js";import{f as ye,_ as ve,a as he}from"./replace-0f72c922.js";import{b as we,_ as ke,u as xe}from"./user-8d183462.js";import{P as Re}from"./pagination-db6078c7.js";/* empty css                      */import"./index-971e6ee4.js";/* empty css                                                                   */const M=v=>(_e("data-v-d7911da2"),v=v(),be(),v),qe={style:{height:"100%"}},Te={key:0,class:"box",style:{"flex-direction":"column","padding-top":"24px"}},Ve={class:"flex",style:{flex:"1"}},Ce={class:"table-content"},Ee={class:"header",style:{"background-color":"#fff"}},Le={style:{display:"flex","align-items":"center"}},De={key:1,class:"box empower"},Be={class:"center"},Fe=M(()=>f("img",{src:me},null,-1)),Ie=M(()=>f("p",{style:{"font-size":"12px",color:"#333333","margin-top":"12px"}}," \u987B\u4F7F\u7528\u5177\u6709\u6570\u636E\u5E93\u7BA1\u7406\u6743\u9650\u7684\u8D26\u53F7\u8FDE\u63A5\u6570\u636E\u5E93 ",-1)),$e={__name:"fieldlist",setup(v){const V=u(),S=u(),P=u(),K=u(),z=u(),r=fe(),C=u(),d=w({form:{},loading:!1,dbModel:!1,load(){le().then(l=>{n.loadAll(),o.load(),d.dbModel=!0}).catch(l=>{d.dbModel=!1,console.log(l,"======")})},save:ue("debounce")(l=>{!l||l.validate(s=>{s&&(d.loading=!0,te(d.form).then(()=>{d.load(),H({position:"bottom-right",type:"success",message:"\u94FE\u63A5\u6210\u529F"})}).finally(()=>{d.loading=!1}))})},300)});d.load();const g=u(1),n=w({loading:!1,data:[],searchVal:{keywords:"",order:""},searchValMap:[],search:!1,openeds:[],dbTabel:[],activeDb:r.query.name,activeTable:r.query.field,currentKey:"",loadAll(){o.loading=!0,se({db_name:r.query.name,table_name:r.query.field}).then(l=>{o.loading=!1,c.data=l.list})},rightTable(){n.loadAll(),o.load()}}),E=u(),c=w({visible:!1,loading:!1,data:[],open:l=>{E.value.open(l,{db_name:r.query.name,table_name:r.query.field})},del:l=>{ee({message:"\u786E\u5B9A\u8981\u5220\u9664\u8BE5\u5B57\u6BB5\u5417\uFF1F",okEms:"\u5220\u9664\u6210\u529F"},()=>pe({db_name:n.activeDb,table_name:n.activeTable,column:l}).then(s=>(n.loadAll(),s)))}}),o=w({activeKey:1,pageinfo:{pageIndex:1,pageSize:20,total:0},data:[],loading:!1,formatPage(l=o.pageinfo){o.pageinfo=l,o.load(),console.log(l,"===")},load(){o.loading=!0,re({db_name:n.activeDb,table_name:n.activeTable,page:o.pageinfo.pageIndex,limit:o.pageinfo.pageSize}).then(l=>{o.data=l.rows,o.columns=l.columns,o.pageinfo.total=l.total,console.log(l)}).finally(()=>{o.loading=!1})}});return ne().then(l=>{g.value=l.dbType,console.log(g.value," ======\u7CFB\u7EDF1pg,2myspl")}),(l,s)=>{var I,$;const k=de,N=ie,y=W,L=Z,U=J,_=oe,D=ae,B=O,F=Q,j=X,x=Y;return p(),b("div",qe,[e(d).dbModel?R((p(),b("div",Te,[a(ge,{class:"plug-header_header"},{default:t(()=>[a(N,{separator:"/"},{default:t(()=>[a(k,{to:{name:"newDatabaseTool"}},{default:t(()=>[m("\u6570\u636E\u5E93\u7BA1\u7406")]),_:1}),a(k,{to:{name:"newDatabasesheet",query:{name:e(r).query.name}}},{default:t(()=>[m(T(e(r).query.name),1)]),_:1},8,["to"]),a(k,{to:{name:"newDatabasefieldlist",query:{name:e(r).query.name,field:e(r).query.field}}},{default:t(()=>[m(T(e(r).query.field),1)]),_:1},8,["to"])]),_:1})]),_:1}),f("div",Ve,[R((p(),b("div",Ce,[f("div",Ee,[f("div",null,[a(y,{type:"primary",onClick:s[0]||(s[0]=i=>e(c).open({}))},{default:t(()=>[m("\u65B0\u589E\u5B57\u6BB5")]),_:1}),a(y,{type:"primary",onClick:s[1]||(s[1]=i=>e(V).open({database:e(n).activeDb,table:e(n).activeTable,filed:e(c).data}))},{default:t(()=>[m("\u6279\u91CF\u66FF\u6362")]),_:1})]),f("div",Le,[a(U,{modelValue:e(o).activeKey,"onUpdate:modelValue":s[2]||(s[2]=i=>e(o).activeKey=i),onChange:s[3]||(s[3]=i=>e(n).rightTable(e(n).activeTable))},{default:t(()=>[a(L,{label:1},{default:t(()=>[m("\u5185\u5BB9\u7BA1\u7406")]),_:1}),a(L,{label:2},{default:t(()=>[m("\u5B57\u6BB5\u7BA1\u7406")]),_:1})]),_:1},8,["modelValue"])])]),e(o).activeKey==2?(p(),q(D,{key:0,data:((I=e(c))==null?void 0:I.data)||[],class:"auto",stripe:!0},{default:t(()=>[a(_,{"min-width":"80",label:"\u5B57\u6BB5\u540D\u79F0",prop:"name","show-overflow-tooltip":!0}),a(_,{"min-width":"80",label:"\u5B57\u6BB5\u7C7B\u578B",prop:"data_type","show-overflow-tooltip":!0}),a(_,{"min-width":"80",label:"\u957F\u5EA6",prop:"length","show-overflow-tooltip":!0}),a(_,{"min-width":"80",label:"\u5907\u6CE8",prop:"comment","show-overflow-tooltip":!0}),a(_,{fixed:"right",label:"\u64CD\u4F5C",align:"right","min-width":"110"},{default:t(({row:i})=>[a(y,{type:"primary",link:"",onClick:h=>e(c).open(i)},{default:t(()=>[m(" \u7F16\u8F91 ")]),_:2},1032,["onClick"]),a(y,{type:"danger",link:"",onClick:h=>e(c).del(i.name)},{default:t(()=>[m(" \u5220\u9664 ")]),_:2},1032,["onClick"])]),_:1})]),_:1},8,["data"])):(p(),b(A,{key:1},[a(D,{data:(($=e(o))==null?void 0:$.data)||[],class:"auto jh_table",stripe:!0},{default:t(()=>{var i;return[(p(!0),b(A,null,ce((i=e(o))==null?void 0:i.columns,h=>(p(),q(_,{label:h,prop:h,"min-width":"120","show-overflow-tooltip":!0},null,8,["label","prop"]))),256))]}),_:1},8,["data"]),a(Re,{pageinfo:e(o).pageinfo,onChange:e(o).formatPage,class:"ml-auto"},null,8,["pageinfo","onChange"])],64))])),[[x,e(o).loading]]),a(xe,{ref_key:"userRef",ref:S},null,512),a(we,{ref_key:"backupsRef",ref:P,onLoad:e(n).load},null,8,["onLoad"]),a(ye,{system:e(g),ref_key:"fieldRef",ref:E,onLoad:e(n).rightTable},null,8,["system","onLoad"]),a(ke,{ref_key:"dbRef",ref:K,system:e(g),onLoad:e(n).loadAll},null,8,["system","onLoad"]),a(ve,{ref_key:"dbTableRef",ref:z,onLoad:e(n).load},null,8,["onLoad"]),a(he,{ref_key:"replaceRef",ref:V,onLoad:e(n).rightTable},null,8,["onLoad"])])])),[[x,e(n).loading]]):(p(),b("div",De,[f("div",Be,[Fe,a(j,{ref_key:"empowerFormRef",ref:C,"label-width":"90px",model:e(d).form,class:"empowerForm",style:{"max-width":"460px"},"hide-required-asterisk":""},{default:t(()=>[f("h4",null,"\u8FDE\u63A5\u6570\u636E\u5E93("+T(e(g)==1?"pg":"mysql")+")",1),Ie,a(F,{prop:"user_name",label:"\u8D26\u53F7",rules:{required:!0,message:"\u8BF7\u8F93\u5165\u8D26\u53F7",trigger:"blur"}},{default:t(()=>[a(B,{placeholder:"\u8BF7\u8F93\u5165\u8D26\u53F7",clearable:"",modelValue:e(d).form.user_name,"onUpdate:modelValue":s[4]||(s[4]=i=>e(d).form.user_name=i),modelModifiers:{trim:!0}},null,8,["modelValue"])]),_:1}),a(F,{prop:"password",label:"\u5BC6\u7801",rules:{required:!0,message:"\u8BF7\u8F93\u5165\u5BC6\u7801",trigger:"blur"}},{default:t(()=>[a(B,{placeholder:"\u8BF7\u8F93\u5165\u5BC6\u7801",clearable:"",type:"password","show-password":"",modelValue:e(d).form.password,"onUpdate:modelValue":s[5]||(s[5]=i=>e(d).form.password=i),modelModifiers:{trim:!0}},null,8,["modelValue"])]),_:1}),R((p(),q(y,{type:"primary",onClick:s[6]||(s[6]=i=>e(d).save(e(C))),class:"submit"},{default:t(()=>[m("\u8FDE\u63A5")]),_:1})),[[x,e(d).loading]])]),_:1},8,["model"])])]))])}}},We=G($e,[["__scopeId","data-v-d7911da2"]]);export{We as default};

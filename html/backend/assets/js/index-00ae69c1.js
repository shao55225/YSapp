import{_ as w,av as M,j as E,v as I,C as N,U as V,o as H,ci as P,cj as $,m as q,E as z}from"./entry-9cc5c370.js";/* empty css                        */import{a as R,Z as j,d as A,m as O,p as t,a6 as s,W as c,u as f,U as y,R as r,S as i,O as m,L as k,M as U,as as D,l as d,ap as F,aq as W,at as Z}from"./vue-11eabec3.js";import{p as G,c as J,h as K}from"./repository-d7a349f9.js";import{P as Q}from"./pagination-db6078c7.js";/* empty css                      */import"./index-971e6ee4.js";/* empty css                                                                   */const v=g=>(F("data-v-d07c07a3"),g=g(),W(),g),X={class:"flex-y box"},Y={class:"head-b"},ee={class:"flex header"},te=v(()=>t("i",{class:"iconfont icon-fanhui"},null,-1)),ae=v(()=>t("span",{class:"line"},null,-1)),oe=v(()=>t("span",{class:"line"},null,-1)),se={class:"tab"},ne={style:{"font-size":"14px"}},le={style:{"text-align":"right","min-width":"100px"}},ie={style:{color:"#4b82fa"}},de={style:{color:"#5ad8a6"}},ce={style:{color:"#c84141"}},re=["innerHTML"],ue=["innerHTML"],pe=["innerHTML"],_e={__name:"index",setup(g){const h=D(),p=R({pageIndex:1,pageSize:1,total:0}),b=Z();let x;const S=h.query.n,e=j({loading:!1,data:[],searchVal:{wd:"",t:0,order:"",status:void 0,keywords:""},selectList:[],categories:[],resource:{},load(n){b.currentRoute.value.name==="collectProgress"&&(clearTimeout(x),p.value=n||p.value,e.loading=!0,G(Number(h.query.i),{}).then(a=>{var l;e.loading=!1,a.status==0&&(x=setTimeout(()=>{e.load()},1e3)),p.value.pageIndex=a.currentPage,a.records=(l=a.records)==null?void 0:l.filter(u=>u),e.data=a}).catch(a=>{e.loading=!1}))},handleSelectionChange(n){e.selectList=n},sortChnage({column:n,prop:a,order:l}){l?e.searchVal.order=`${a} ${l==="ascending"?"asc":"desc"}`:e.searchVal.order="",e.load()}}),L={cancel:()=>N({message:"\u786E\u5B9A\u8981\u505C\u6B62\u91C7\u96C6\u5417\uFF1F",okEms:"\u64CD\u4F5C\u6210\u529F"},()=>J(Number(h.query.resource_id),{siteId:0}).then(n=>(e.load(),n))),changeType(n){e.searchVal.t=n,p.value.pageIndex=1,e.load()},stop(n){e.loading=!0,V({title:"\u63D0\u793A",message:"\u5F53\u524D\u91C7\u96C6\u4EFB\u52A1\u8FDB\u884C\u4E2D,\u662F\u5426\u7EE7\u7EED\u91C7\u96C6",showCancelButton:!0,closeOnClickModal:!1,confirmButtonText:"\u7EE7\u7EED\u91C7\u96C6",cancelButtonText:"\u91CD\u65B0\u91C7\u96C6",showClose:!0,distinguishCancelAndClose:!0,icon:"",buttonSize:"small",beforeClose:(a,l,u)=>{l.confirmButtonLoading=!0,l.cancelButtonLoading=!0,console.log(a),a!=="close"?K(n,a!=="confirm").then(()=>{setTimeout(()=>{l.confirmButtonLoading=!1,l.cancelButtonLoading=!1},100)}).then(()=>{z({position:"bottom-right",type:"success",message:"\u64CD\u4F5C\u6210\u529F"}),u(),setTimeout(()=>e.load(),0)}).catch(()=>{history.back()}):(setTimeout(()=>e.load(),0),u())}})}};return A(()=>{e.load()}),(n,a)=>{var C;const l=M,u=E,_=q,T=H,B=I;return d(),O("div",X,[t("div",Y,[t("div",ee,[t("span",{class:"point",onClick:a[0]||(a[0]=o=>n.$router.go(-1))},[te,s("\u8FD4\u56DE")]),ae,t("span",null,c(e.data.name||"\u540D\u79F0\u540D\u79F0"),1),oe,t("div",se,[t("span",null,"\u3010"+c(e.data.collectOp=="month"?"\u91C7\u96C6\u672C\u6708":f(S))+"\u3011",1),y(l,{style:{flex:"1","margin-right":"16px"},percentage:Number(((C=e.data)==null?void 0:C.rate)||0)},null,8,["percentage"]),t("p",null,[t("span",ne,[t("span",null,c(e.data.currentPage),1),s("/"+c(e.data.pageTotal),1)]),s(" \u9875 ")])]),t("div",le,[e.data.status==2?(d(),r(u,{key:0,icon:f(P),style:{color:"red"},link:""},{default:i(()=>[s(" \u91C7\u96C6\u5DF2\u505C\u6B62 ")]),_:1},8,["icon"])):e.data.status==1?(d(),r(u,{key:1,icon:f($),style:{color:"#5ad8a6"},link:""},{default:i(()=>[s(" \u91C7\u96C6\u5DF2\u5B8C\u6210 ")]),_:1},8,["icon"])):(d(),r(u,{key:2,loading:!0,type:"primary",link:""},{default:i(()=>[s(" \u91C7\u96C6\u4E2D ")]),_:1})),e.data.finish_num<e.data.total_num&&e.data.status==0?(d(),r(u,{key:3,type:"danger",link:"",style:{"":"16px"},onClick:a[1]||(a[1]=o=>L.cancel())},{default:i(()=>[s(" \u505C\u6B62\u91C7\u96C6 ")]),_:1})):m("",!0)])])]),e.data.status!==0?(d(),r(T,{key:0,data:e.data.result||[],class:"auto",stripe:!0},{default:i(()=>[y(_,{prop:"vod_name",label:"\u7AD9\u70B9","min-width":"100"},{default:i(({row:o})=>[t("span",null,[s(c(o.siteName)+"\u2002( ",1),t("span",ie,"\u66F4\u65B0\uFF1A"+c(o.UpdateTotal),1),s("\uFF1B "),t("span",de,"\u65B0\u589E\uFF1A"+c(o.AddTotal),1),s("\uFF1B "),t("span",ce,"\u5931\u8D25\uFF1A"+c(o.FailTotal),1),s("\uFF1B "),t("span",null,"\u91C7\u96C6\u603B\u6570\uFF1A"+c(o.Total),1),s(" )")])]),_:1})]),_:1},8,["data"])):k((d(),r(T,{key:1,data:e.data.records||[],class:"auto",stripe:!0,onSortChange:e.sortChnage,onSelectionChange:e.handleSelectionChange},{default:i(()=>[y(_,{type:"index",label:"\u5E8F\u53F7",width:"120px"},{default:i(({$index:o})=>[s(c((p.value.pageIndex-1)*e.data.pageSize+o+1),1)]),_:1}),e.data.dataType===1?(d(),r(_,{key:0,label:"\u5F71\u7247\u540D\u79F0","min-width":"100"},{default:i(({row:o})=>[t("div",{innerHTML:o},null,8,re)]),_:1})):m("",!0),e.data.dataType===2?(d(),r(_,{key:1,label:"\u5F71\u4EBA\u540D\u79F0","min-width":"100"},{default:i(({row:o})=>[t("div",{innerHTML:o},null,8,ue)]),_:1})):m("",!0),e.data.dataType===3?(d(),r(_,{key:2,label:"\u56FE\u6587\u540D\u79F0","min-width":"100"},{default:i(({row:o})=>[t("div",{innerHTML:o},null,8,pe)]),_:1})):m("",!0)]),_:1},8,["data","onSortChange","onSelectionChange"])),[[B,e.loading]]),e.data.status==0?k((d(),r(Q,{key:2,layout:"total,prev,pager,next,jumper",pageinfo:p.value,onChange:e.load},null,8,["pageinfo","onChange"])),[[U,e.data.finish_num>=e.data.total_num||e.data.status==2]]):m("",!0)])}}},Ce=w(_e,[["__scopeId","data-v-d07c07a3"]]);export{Ce as default};

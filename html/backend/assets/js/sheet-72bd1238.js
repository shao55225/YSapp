import{_ as Z,E as D,cO as G,s as J,j as X,b as Y,c as ee,i as ae,v as oe,C as E,T as se,o as te,w as le,m as ne}from"./entry-9cc5c370.js";/* empty css                        */import{a as ie,s as de,u as re,b as pe,E as me,c as ce,_ as ue,r as _e,o as fe}from"./databaseInfo-fa5b31e0.js";import{a as _,Z as A,z as be,n as ge,m as C,u as e,L as S,U as s,S as d,p as l,Q as $,a6 as m,O as he,ag as ye,as as ve,l as k,W as N,R as ke,ap as we,aq as xe,at as Ce}from"./vue-11eabec3.js";import{r as Ve}from"./databaseSql-300e3b23.js";import{P as $e}from"./pagination-db6078c7.js";import{p as Ne}from"./plugHeader-c50619f4.js";import{b as Re,_ as Te,u as Ee}from"./user-8d183462.js";import{f as Ae,_ as Se,a as qe}from"./replace-0f72c922.js";/* empty css                      */import"./index-971e6ee4.js";/* empty css                                                                   */const h=V=>(we("data-v-44848c21"),V=V(),xe(),V),Ie={style:{height:"100%"}},Le={key:0,class:"box",style:{"flex-direction":"column","padding-top":"24px"}},ze={class:"flex",style:{flex:"1"}},De={class:"table-content"},Be={class:"header"},Me={class:"btns"},Fe=h(()=>l("div",null,[l("p",null,[l("i",{style:{"font-size":"24px"},class:"icon iconfont icon-biaoguanli"})]),l("p",null,"\u65B0\u5EFA\u8868")],-1)),Ke=[Fe],Pe={class:"other"},Ue=h(()=>l("i",{class:"icon iconfont icon-beifen point"},null,-1)),je=h(()=>l("i",{class:"icon iconfont icon-huanyuan point"},null,-1)),Oe={class:"other"},We=h(()=>l("i",{class:"icon iconfont icon-xiufu point"},null,-1)),He=h(()=>l("i",{class:"icon iconfont icon-shanchushujuku point"},null,-1)),Qe={class:"search flex-x-center",style:{margin:"0","padding-right":"24px"}},Ze={key:0,class:"dewindwos"},Ge=["onClick"],Je={key:1,class:"box empower"},Xe={class:"center"},Ye=h(()=>l("img",{src:ue},null,-1)),ea=h(()=>l("p",{style:{"font-size":"12px",color:"#333333","margin-top":"12px"}}," \u987B\u4F7F\u7528\u5177\u6709\u6570\u636E\u5E93\u7BA1\u7406\u6743\u9650\u7684\u8D26\u53F7\u8FDE\u63A5\u6570\u636E\u5E93 ",-1)),aa={__name:"sheet",setup(V){const B=_(),M=_(),R=_(),F=_(),b=_(),w=ve(),K=Ce(),u=_({databaseName:w.query.name}),c=_([]),q=_(),p=A({form:{},loading:!1,dbModel:!1,load(){ie().then(n=>{o.loadAll(),p.dbModel=!0}).catch(n=>{p.dbModel=!1,console.log(n,"======")})},save:be("debounce")(n=>{!n||n.validate(a=>{a&&(p.loading=!0,de(p.form).then(()=>{p.load(),D({position:"bottom-right",type:"success",message:"\u94FE\u63A5\u6210\u529F"})}).finally(()=>{p.loading=!1}))})},300)});p.load();const P=_(1),x=_(1),o=A({loading:!1,os:"",data:[],searchVal:{keywords:"",order:""},searchValMap:[],search:!1,openeds:[],dbTabel:[],activeDb:w.query.name,activeTable:"",currentKey:"",load(){if(o.searchVal.keywords){o.loadSearch();return}o.loadAll()},loadAll(){o.loading=!0,re({page:f.pageinfo.pageIndex,limit:f.pageinfo.pageSize,db_name:w.query.name,keywords:o.searchVal.keywords}).then(n=>{o.loading=!1,o.data=n.list,f.pageinfo.total=n.total,u.value,ge(()=>{P.value=1,o.dbTabel=n.list||[]})})},loadSearch(){f.pageinfo.pageSize=20,f.pageinfo.pageIndex=1,o.loadAll()}}),U=_(),f=A({activeKey:1,pageinfo:{pageIndex:1,pageSize:20,total:0},data:[],loading:!1,formatPage:(n=f.pageinfo)=>{f.pageinfo=n,o.loadAll(),console.log(n,"===")}}),I={repair:(n,a)=>E({message:"\u786E\u5B9A\u8981\u4FEE\u590D\u5417?",okEms:(a?"\u6570\u636E\u8868":"\u6570\u636E\u5E93")+"\u4FEE\u590D\u6210\u529F"},()=>_e({db_name:n,table_names:a||[]}).then(y=>(o.load(),y))),optimize:(n,a)=>E({message:"\u786E\u5B9A\u8981\u4F18\u5316\u5417?",okEms:"\u6570\u636E\u5E93\u4F18\u5316\u6210\u529F"},()=>fe({db_name:n,table_names:a||[]}).then(y=>(o.load(),y))),restore:n=>E({message:"\u786E\u5B9A\u8981\u8FD8\u539F\u6570\u636E\u5E93\u5417?",okEms:"\u6570\u636E\u8868\u8FD8\u539F\u6210\u529F"},()=>Ve(o.activeDb).then(a=>{D({position:"bottom-right",type:"success",message:"\u8FD8\u539F\u6210\u529F"}),o.load()}))};return pe().then(n=>{x.value=n.dbType,console.log(x.value," ======\u7CFB\u7EDF1pg,2myspl")}),G().then(n=>{o.os=n.os,console.log(n.os," ======\u7CFB\u7EDF1pg,2myspl")}),(n,a)=>{const y=me,j=ce,O=J,W=se,g=ne,v=X,H=te,L=Y,z=ee,Q=ae,T=oe;return k(),C("div",Ie,[e(p).dbModel?S((k(),C("div",Le,[s(Ne,{class:"plug-header_header"},{default:d(()=>[s(j,{separator:"/"},{default:d(()=>[s(y,{to:{name:"newDatabaseTool"}},{default:d(()=>[m("\u6570\u636E\u5E93\u7BA1\u7406")]),_:1}),s(y,{to:{name:"newDatabasesheet",query:{name:e(w).query.name}}},{default:d(()=>[m(N(e(w).query.name),1)]),_:1},8,["to"])]),_:1})]),_:1}),l("div",ze,[S((k(),C("div",De,[l("div",Be,[l("div",Me,[l("div",{class:"point",onClick:a[0]||(a[0]=t=>{var i;return(i=e(b))==null?void 0:i.open(e(u).databaseName)})},Ke),l("div",Pe,[l("p",{class:$({disabled:e(c).length<=0||e(o).os=="windows"}),onClick:a[1]||(a[1]=t=>{var i;return e(c).length>0&&e(o).os=="linux"?(i=e(R))==null?void 0:i.openBody(e(u).databaseName,e(c).map(r=>r.name)):""})},[Ue,m("\u5907\u4EFD ")],2),l("p",{class:$({disabled:e(c).length<=0}),onClick:a[2]||(a[2]=t=>{var i;return e(c).length>0?(i=e(b))==null?void 0:i.clear(e(u).databaseName,e(c).map(r=>r.name)):""})},[je,m("\u6E05\u7A7A ")],2)]),l("div",Oe,[l("p",{class:$({disabled:e(c).length<=0||e(o).os=="windows"}),onClick:a[3]||(a[3]=t=>e(c).length>0&&e(o).os=="linux"?I.repair(e(u).databaseName,e(c).map(i=>i.name)):"")},[We,m("\u4FEE\u590D ")],2),l("p",{class:$({disabled:e(c).length<=0}),onClick:a[4]||(a[4]=t=>{var i;return e(c).length>0?(i=e(b))==null?void 0:i.del(e(u).databaseName,e(c).map(r=>r.name)):""})},[He,m("\u5220\u9664 ")],2)])]),l("div",Qe,[e(o).os=="windows"?(k(),C("span",Ze,[s(O,{style:{"margin-right":"6px"}},{default:d(()=>[s(e(le))]),_:1}),m(" Windows\u7CFB\u7EDF\u4E0D\u652F\u6301\u90E8\u5206\u529F\u80FD")])):he("",!0),s(W,{modelValue:e(o).searchVal.keywords,"onUpdate:modelValue":a[5]||(a[5]=t=>e(o).searchVal.keywords=t),onClear:a[6]||(a[6]=t=>{e(o).searchValMap=[],e(o).search=!1}),onKeyup:a[7]||(a[7]=ye(t=>e(o).loadSearch(),["enter","native"]))},null,8,["modelValue"])])]),s(H,{data:e(o).dbTabel||[],class:"auto",stripe:!0,onSelectionChange:a[8]||(a[8]=t=>c.value=t)},{default:d(()=>[s(g,{type:"selection","min-width":"20",class:"checkAll"}),s(g,{"min-width":"80",label:"\u6570\u636E\u8868",prop:"name","show-overflow-tooltip":!0},{default:d(({row:t})=>[l("span",{onClick:i=>e(K).push({name:"newDatabasefieldlist",query:{name:e(u).databaseName,field:t.name}}),style:{color:"#4b82fa",cursor:"pointer"}},N(t.name),9,Ge)]),_:1}),s(g,{"min-width":"80",label:"\u5B57\u7B26\u96C6",prop:"charset","show-overflow-tooltip":!0}),s(g,{"min-width":"80",label:"\u884C\u6570"},{default:d(({row:t})=>[m(N(t.row_count||0),1)]),_:1}),s(g,{"min-width":"80",label:"\u5B57\u6BB5\u6570",prop:"column_count","show-overflow-tooltip":!0}),s(g,{"min-width":"80",label:"\u5927\u5C0F",prop:"kb_size","show-overflow-tooltip":!0}),s(g,{fixed:"right",label:"\u64CD\u4F5C",align:"right",width:"300"},{default:d(({row:t})=>[s(v,{type:"primary",link:"",disabled:e(o).os=="windows",onClick:i=>I.repair(e(u).databaseName,[t.name])},{default:d(()=>[m(" \u4FEE\u590D ")]),_:2},1032,["disabled","onClick"]),s(v,{type:"primary",link:"",disabled:e(o).os=="windows",onClick:i=>{var r;return(r=e(R))==null?void 0:r.open(e(u).databaseName,t.name)}},{default:d(()=>[m(" \u5907\u4EFD ")]),_:2},1032,["disabled","onClick"]),s(v,{type:"primary",link:"",onClick:i=>{var r;return(r=e(b))==null?void 0:r.open(e(u).databaseName,t.name)}},{default:d(()=>[m(" \u7F16\u8F91 ")]),_:2},1032,["onClick"]),s(v,{type:"danger",link:"",onClick:i=>{var r;return(r=e(b))==null?void 0:r.clear(e(u).databaseName,[t.name])}},{default:d(()=>[m(" \u6E05\u7A7A ")]),_:2},1032,["onClick"]),s(v,{type:"danger",link:"",onClick:i=>{var r;return(r=e(b))==null?void 0:r.del(e(u).databaseName,[t.name])}},{default:d(()=>[m(" \u5220\u9664 ")]),_:2},1032,["onClick"])]),_:1})]),_:1},8,["data"]),s($e,{pageinfo:e(f).pageinfo,onChange:e(f).formatPage,class:"ml-auto"},null,8,["pageinfo","onChange"])])),[[T,e(f).loading]]),s(Ee,{ref_key:"userRef",ref:M},null,512),s(Re,{ref_key:"backupsRef",ref:R,onLoad:e(o).load},null,8,["onLoad"]),s(Ae,{system:e(x),ref_key:"fieldRef",ref:U,onLoad:a[9]||(a[9]=t=>e(o).rightTable(e(o).activeTable))},null,8,["system"]),s(Te,{ref_key:"dbRef",ref:F,system:e(x),onLoad:e(o).loadAll},null,8,["system","onLoad"]),s(Se,{ref_key:"dbTableRef",ref:b,onLoad:e(o).load},null,8,["onLoad"]),s(qe,{ref_key:"replaceRef",ref:B,onLoad:a[10]||(a[10]=t=>e(o).rightTable(e(o).activeTable))},null,512)])])),[[T,e(o).loading]]):(k(),C("div",Je,[l("div",Xe,[Ye,s(Q,{ref_key:"empowerFormRef",ref:q,"label-width":"90px",model:e(p).form,class:"empowerForm",style:{"max-width":"460px"},"hide-required-asterisk":""},{default:d(()=>[l("h4",null,"\u8FDE\u63A5\u6570\u636E\u5E93("+N(e(x)==1?"pg":"mysql")+")",1),ea,s(z,{prop:"user_name",label:"\u8D26\u53F7",rules:{required:!0,message:"\u8BF7\u8F93\u5165\u8D26\u53F7",trigger:"blur"}},{default:d(()=>[s(L,{placeholder:"\u8BF7\u8F93\u5165\u8D26\u53F7",clearable:"",modelValue:e(p).form.user_name,"onUpdate:modelValue":a[11]||(a[11]=t=>e(p).form.user_name=t),modelModifiers:{trim:!0}},null,8,["modelValue"])]),_:1}),s(z,{prop:"password",label:"\u5BC6\u7801",rules:{required:!0,message:"\u8BF7\u8F93\u5165\u5BC6\u7801",trigger:"blur"}},{default:d(()=>[s(L,{placeholder:"\u8BF7\u8F93\u5165\u5BC6\u7801",clearable:"",type:"password","show-password":"",modelValue:e(p).form.password,"onUpdate:modelValue":a[12]||(a[12]=t=>e(p).form.password=t),modelModifiers:{trim:!0}},null,8,["modelValue"])]),_:1}),S((k(),ke(v,{type:"primary",onClick:a[13]||(a[13]=t=>e(p).save(e(q))),class:"submit"},{default:d(()=>[m("\u8FDE\u63A5")]),_:1})),[[T,e(p).loading]])]),_:1},8,["model"])])]))])}}},_a=Z(aa,[["__scopeId","data-v-44848c21"]]);export{_a as default};

import{_ as B,E as D,b as H,c as M,g as ee,i as W,j as T,k as X,F as le,G as ae,u as te,d as oe,f as se,h as ne,v as de,T as ie,o as re,C as ue,m as pe}from"./entry-9cc5c370.js";import{P as ce}from"./pagination-db6078c7.js";/* empty css                        */import{E as _e,a as me}from"./el-tab-pane-8ec9369b.js";import{p as fe}from"./plugHeader-c50619f4.js";import{l as L}from"./prefix-78671e4d.js";import{Z as E,a as F,l as V,R as z,S as t,U as e,a6 as y,u as n,p as _,ap as Z,aq as J,O as N,m as R,L as G,P as ge,af as be,W as U,X as he}from"./vue-11eabec3.js";/* empty css                      */import"./index-971e6ee4.js";/* empty css                                                                   */const K=k=>(Z("data-v-c2edc4c9"),k=k(),J(),k),ve={class:"flex-y-center",style:{gap:"12px"}},ye=K(()=>_("span",{style:{"font-size":"12px"}},"0\u4E3A\u4E0D\u9650",-1)),ke={class:"flex-y-center",style:{gap:"12px"}},xe=K(()=>_("span",{style:{"font-size":"12px"}},"\u79D2",-1)),Ve={__name:"config",emits:["load"],setup(k,{expose:S,emit:w}){const i=E({loading:!1,visible:!1,other:void 0,tags:!1}),b=F(),o=E({max_daily:0,gap:1,blocked_keywords:""}),r=()=>{b.value.validate((c,s)=>{if(c){i.loading=!0;let a={};i.tags?a=[{...i.other,max_daily:o.max_daily,gap:o.gap,blocked_keywords:o.blocked_keywords}]:a=i.other.map(u=>(u.max_daily=o.max_daily,u.gap=o.gap,u.blocked_keywords=o.blocked_keywords,u)),L.setConfig(a).then(u=>{D({position:"bottom-right",type:"success",message:"\u7F16\u8F91\u6210\u529F"}),i.visible=!1,w("load")}).finally(()=>{i.loading=!1})}})},m=()=>{var c;i.visible=!1,o.max_daily=0,o.gap=1,o.blocked_keywords="",(c=b.value)==null||c.resetFields()},I=()=>{};return S({open(c,s=!1){i.visible=!0,i.other=c,i.tags=s,s&&(o.max_daily=c.max_daily,o.gap=c.gap,o.blocked_keywords=c.blocked_keywords)}}),(c,s)=>{const a=H,u=M,g=ee,h=W,v=T,$=X;return V(),z($,{"model-value":n(i).visible,"show-close":!n(i).loading,"close-on-press-escape":!1,title:"\u7F16\u8F91\u914D\u7F6E",width:400,"z-index":20,top:"25vh","close-on-click-modal":!1,onClose:m,onOpened:I},{footer:t(()=>[e(v,{class:"ml-auto",size:"small",loading:n(i).loading,onClick:m},{default:t(()=>[y(" \u53D6\u6D88 ")]),_:1},8,["loading"]),e(v,{class:"ml-auto",size:"small",type:"primary",loading:n(i).loading,onClick:s[3]||(s[3]=x=>r())},{default:t(()=>[y(" \u4FDD\u5B58 ")]),_:1},8,["loading"])]),default:t(()=>[e(h,{ref_key:"ruleFormRef",ref:b,"label-width":"90px",model:n(o),style:{"margin-top":"8px"},rules:{},"hide-required-asterisk":!1},{default:t(()=>[e(u,{label:"\u5F39\u5E55\u5BA1\u6838"},{default:t(()=>[e(a,{type:"textarea",modelValue:n(o).blocked_keywords,"onUpdate:modelValue":s[0]||(s[0]=x=>n(o).blocked_keywords=x),placeholder:"\u8BF7\u8F93\u5165\u5F39\u5E55\u5173\u952E\u5B57\uFF0C\u4EE5|\u8FDB\u884C\u5206\u5272",rows:6},null,8,["modelValue"])]),_:1}),e(u,{label:"\u65E5\u6700\u5927\u5F39\u5E55\u6570"},{default:t(()=>[_("div",ve,[e(g,{spellcheck:"false",modelValue:n(o).max_daily,"onUpdate:modelValue":s[1]||(s[1]=x=>n(o).max_daily=x),clearable:"",min:0,"controls-position":"right",placeholder:"\u8BF7\u8F93\u5165\u6570\u503C"},null,8,["modelValue"]),ye])]),_:1}),e(u,{label:"\u5F39\u5E55\u95F4\u9694\u65F6\u957F"},{default:t(()=>[_("div",ke,[e(g,{spellcheck:"false",modelValue:n(o).gap,"onUpdate:modelValue":s[2]||(s[2]=x=>n(o).gap=x),clearable:"",min:0,"controls-position":"right",placeholder:"\u8BF7\u8F93\u5165\u6570\u503C"},null,8,["modelValue"]),xe])]),_:1})]),_:1},8,["model"])]),_:1},8,["model-value","show-close"])}}},Ce=B(Ve,[["__scopeId","data-v-c2edc4c9"]]);const Se={__name:"audit",emits:["load"],setup(k,{expose:S,emit:w}){const i=E({loading:!1,visible:!1,other:void 0}),b=F(),o=E({status:2,reject_reason:"",ids:[]}),r=()=>{b.value.validate((c,s)=>{c&&(i.loading=!0,L.audit(o).then(a=>{D({position:"bottom-right",type:"success",message:"\u5BA1\u6838\u6210\u529F"}),i.visible=!1,w("load")}).finally(()=>{i.loading=!1}))})},m=()=>{var c;i.visible=!1,o.status=2,o.reject_reason="",(c=b.value)==null||c.resetFields()},I=()=>{};return S({open(c){i.visible=!0,o.ids=c}}),(c,s)=>{const a=le,u=ae,g=M,h=H,v=W,$=T,x=X;return V(),z(x,{"model-value":n(i).visible,"show-close":!n(i).loading,"close-on-press-escape":!1,title:"\u5BA1\u6838",width:400,"z-index":20,top:"25vh","close-on-click-modal":!1,onClose:m,onOpened:I},{footer:t(()=>[e($,{class:"ml-auto",size:"small",loading:n(i).loading,onClick:m},{default:t(()=>[y(" \u53D6\u6D88 ")]),_:1},8,["loading"]),e($,{class:"ml-auto",size:"small",type:"primary",loading:n(i).loading,onClick:s[2]||(s[2]=p=>r())},{default:t(()=>[y(" \u4FDD\u5B58 ")]),_:1},8,["loading"])]),default:t(()=>[e(v,{ref_key:"ruleFormRef",ref:b,"label-width":"70px",model:n(o),style:{"margin-top":"8px"},rules:{reject_reason:{required:!0,message:"\u8BF7\u8F93\u5165\u4E0D\u901A\u8FC7\u539F\u56E0",trigger:"blur"}},"hide-required-asterisk":!1},{default:t(()=>[e(g,{label:"\u5BA1\u6838\u72B6\u6001"},{default:t(()=>[e(u,{modelValue:n(o).status,"onUpdate:modelValue":s[0]||(s[0]=p=>n(o).status=p)},{default:t(()=>[e(a,{label:2},{default:t(()=>[y(" \u901A\u8FC7 ")]),_:1}),e(a,{label:3},{default:t(()=>[y(" \u4E0D\u901A\u8FC7 ")]),_:1})]),_:1},8,["modelValue"])]),_:1}),n(o).status==3?(V(),z(g,{key:0,label:"\u539F\u56E0",prop:"reject_reason"},{default:t(()=>[e(h,{type:"textarea",modelValue:n(o).reject_reason,"onUpdate:modelValue":s[1]||(s[1]=p=>n(o).reject_reason=p),placeholder:"\u8BF7\u8F93\u5165\u539F\u56E0",rows:6},null,8,["modelValue"])]),_:1})):N("",!0)]),_:1},8,["model"])]),_:1},8,["model-value","show-close"])}}},we=B(Se,[["__scopeId","data-v-a0962bde"]]);const Q=k=>(Z("data-v-f0774d69"),k=k(),J(),k),Ie={class:"content"},$e={class:"box",style:{"padding-top":"24px"}},Ee={key:0,class:"flex-y",style:{flex:"1",height:"100%"}},Ue={class:"flex-x-between"},Le={class:"flex-x-center search"},ze=Q(()=>_("span",{style:{flexShrink:0}},"\u7AD9\u70B9\u540D\u79F0",-1)),Fe=Q(()=>_("span",{style:{flexShrink:0}},"\u5BA1\u6838\u72B6\u6001",-1)),Re={class:"flex-y-center"},je={key:1,class:"flex-y",style:{flex:"1",height:"100%"}},Ne={class:"flex-x-between",style:{"margin-bottom":"16px"}},Be={__name:"index",setup(k){const S=te(),w=E({type:1}),i=F(),b=F(),o=F({pageIndex:1,pageSize:20,total:0}),r=E({loading:!1,data:[],searchVal:{keywords:"",order:""},selectList:[],load(s){o.value=s||o.value,r.loading=!0,L.get({page:o.value.pageIndex,limit:o.value.pageSize,...r.searchVal}).then(a=>{r.data=a.list,o.value.total=a.total}).finally(()=>{r.loading=!1})},handleSelectionChange(s){r.selectList=s}}),m=E({loading:!1,data:[],selectList:[],load(){m.loading=!0,L.config().then(s=>{m.data=s}).finally(()=>{m.loading=!1})},handleSelectionChange(s){m.selectList=s}});r.load(),m.load();const I={del:s=>ue({message:"\u786E\u5B9A\u8981\u5220\u9664\u5417\uFF1F",okEms:"\u5F39\u5E55\u5220\u9664\u6210\u529F"},()=>L.delete({ids:s}).then(a=>(r.load(),a))),changeStatus(s){m.loading||L.setConfig([s]).then(()=>{D({position:"bottom-right",type:"success",message:"\u4FEE\u6539\u6210\u529F"}),r.load()})}},c=s=>{let a=parseInt(s),u=0,g=0;a>60&&(u=a/60,a=a%60,u>60&&(g=u/60,u=u%60));let h=parseInt(a)>9?parseInt(a):"0"+parseInt(a),v=parseInt(u)>9?parseInt(u):"0"+parseInt(u);return(parseInt(g)>9?parseInt(g):"0"+parseInt(g))+":"+v+":"+h};return(s,a)=>{var A,O;const u=_e,g=me,h=T,v=oe,$=se,x=ie,p=pe,P=re,Y=ce,j=ne,q=de;return V(),R("div",Ie,[_("div",$e,[e(fe,null,{default:t(()=>[e(g,{modelValue:w.type,"onUpdate:modelValue":a[0]||(a[0]=l=>w.type=l),class:"jh-tabs"},{default:t(()=>[e(u,{label:"\u5F39\u5E55\u7BA1\u7406",name:1}),e(u,{label:"\u5F39\u5E55\u914D\u7F6E",name:2})]),_:1},8,["modelValue"])]),_:1}),w.type==1?(V(),R("div",Ee,[_("div",Ue,[_("div",null,[e(h,{disabled:((A=r.selectList)==null?void 0:A.filter(l=>l.status==1).length)<=0,onClick:a[1]||(a[1]=l=>{var d,f;return(f=n(i))==null?void 0:f.open((d=r.selectList)==null?void 0:d.filter(C=>C.status==1).map(C=>C.id))})},{default:t(()=>[y(" \u6279\u91CF\u5BA1\u6838 ")]),_:1},8,["disabled"])]),_("div",Le,[ze,e($,{modelValue:r.searchVal.site_id,"onUpdate:modelValue":a[2]||(a[2]=l=>r.searchVal.site_id=l),class:"m-2",placeholder:"\u6240\u6709\u7AD9\u70B9",clearable:"",onChange:a[3]||(a[3]=l=>r.load())},{default:t(()=>[(V(!0),R(ge,null,be(n(S).list,l=>(V(),z(v,{key:l.id,label:l.name,value:l.id},null,8,["label","value"]))),128))]),_:1},8,["modelValue"]),Fe,e($,{modelValue:r.searchVal.status,"onUpdate:modelValue":a[4]||(a[4]=l=>r.searchVal.status=l),class:"m-2",placeholder:"\u6240\u6709\u5BA1\u6838\u72B6\u6001",clearable:"",onChange:a[5]||(a[5]=l=>r.load())},{default:t(()=>[e(v,{label:"\u672A\u5BA1\u6838",value:1}),e(v,{label:"\u5BA1\u6838\u901A\u8FC7",value:2}),e(v,{label:"\u5BA1\u6838\u672A\u901A\u8FC7",value:3})]),_:1},8,["modelValue"]),e(x,{modelValue:r.searchVal.keywords,"onUpdate:modelValue":a[6]||(a[6]=l=>r.searchVal.keywords=l),onBlur:a[7]||(a[7]=l=>{n(o).pageIndex=1,r.load()})},null,8,["modelValue"])])]),G((V(),z(P,{data:r.data,class:"auto",stripe:!0,onSelectionChange:r.handleSelectionChange},{default:t(()=>[e(p,{type:"selection",width:"40"}),e(p,{"min-width":"100",label:"\u7528\u6237"},{default:t(({row:l})=>{var d;return[_("span",null,U(((d=l==null?void 0:l.formMember)==null?void 0:d.name)||"\u6E38\u5BA2"),1)]}),_:1}),e(p,{prop:"content",label:"\u5F39\u5E55\u5185\u5BB9","min-width":"200"}),e(p,{prop:"site_id",label:"\u6240\u5C5E\u7AD9\u70B9"},{default:t(({row:l})=>{var d,f;return[_("span",null,U(((f=(d=n(S).list)==null?void 0:d.find(C=>C.id==l.site_id))==null?void 0:f.name)||"-"),1)]}),_:1}),e(p,{prop:"resourceName",label:"\u89C6\u9891\u540D\u79F0"}),e(p,{label:"\u5F39\u5E55\u5C55\u793A\u65F6\u95F4",width:"120"},{default:t(({row:l})=>[_("span",null,U(c(l.relative_time)),1)]),_:1}),e(p,{prop:"status",label:"\u5F39\u5E55\u72B6\u6001"},{default:t(({row:l})=>[_("div",Re,[_("span",{class:"tags",style:he({background:["#FAAD14","#52C41A","#FF4D4F"][l.status-1]})},null,4),_("span",null,U(l.status==1?"\u5F85\u5BA1\u6838":l.status==2?"\u901A\u8FC7":"\u4E0D\u901A\u8FC7"),1)])]),_:1}),e(p,{prop:"send_time",label:"\u5F39\u5E55\u53D1\u9001\u65F6\u95F4","show-overflow-tooltip":"",type:"date",sortable:""}),e(p,{label:"\u64CD\u4F5C",align:"right",width:"120"},{default:t(({row:l})=>[e(h,{type:"primary",disabled:l.status!==1,onClick:d=>{var f;return(f=n(i))==null?void 0:f.open([l.id])},link:""},{default:t(()=>[y(" \u5BA1\u6838 ")]),_:2},1032,["disabled","onClick"]),e(h,{type:"danger",onClick:d=>I.del([l.id]),link:""},{default:t(()=>[y(" \u5220\u9664 ")]),_:2},1032,["onClick"])]),_:1})]),_:1},8,["data","onSelectionChange"])),[[q,r.loading]]),e(Y,{pageinfo:n(o),style:{"margin-top":"1rem"},onChange:r.load},null,8,["pageinfo","onChange"]),e(we,{ref_key:"auditRef",ref:i,onLoad:r.load},null,8,["onLoad"])])):N("",!0),w.type==2?(V(),R("div",je,[_("div",Ne,[e(h,{disabled:((O=m.selectList)==null?void 0:O.length)<=0,onClick:a[8]||(a[8]=l=>{var d;return(d=n(b))==null?void 0:d.open(m.selectList)})},{default:t(()=>[y(" \u6279\u91CF\u4FEE\u6539 ")]),_:1},8,["disabled"])]),G((V(),z(P,{data:m.data,class:"auto",stripe:!0,onSelectionChange:m.handleSelectionChange},{default:t(()=>[e(p,{type:"selection",width:"40"}),e(p,{"min-width":"100",prop:"id",label:"ID"}),e(p,{prop:"site_id",label:"\u7AD9\u70B9\u540D\u79F0"},{default:t(({row:l})=>{var d,f;return[_("span",null,U(((f=(d=n(S).list)==null?void 0:d.find(C=>C.id==l.site_id))==null?void 0:f.name)||"-"),1)]}),_:1}),e(p,{label:"\u7AD9\u70B9\u57DF\u540D"},{default:t(({row:l})=>{var d,f;return[_("span",null,U(((f=(d=n(S).list)==null?void 0:d.find(C=>C.id==l.site_id))==null?void 0:f.domain)||"-"),1)]}),_:1}),e(p,{label:"\u5F39\u5E55\u5F00\u542F"},{default:t(({row:l})=>[e(j,{size:"small",modelValue:l.open,"onUpdate:modelValue":d=>l.open=d,onChange:d=>I.changeStatus(l),"active-value":1,"inactive-value":0},null,8,["modelValue","onUpdate:modelValue","onChange"])]),_:1}),e(p,{label:"\u5F39\u5E55\u767B\u5F55"},{default:t(({row:l})=>[e(j,{size:"small",modelValue:l.need_login,"onUpdate:modelValue":d=>l.need_login=d,onChange:d=>I.changeStatus(l),"active-value":1,"inactive-value":0},null,8,["modelValue","onUpdate:modelValue","onChange"])]),_:1}),e(p,{label:"\u5F39\u5E55\u5BA1\u6838"},{default:t(({row:l})=>[e(j,{size:"small",modelValue:l.auto_review,"onUpdate:modelValue":d=>l.auto_review=d,onChange:d=>I.changeStatus(l),"active-value":1,"inactive-value":0},null,8,["modelValue","onUpdate:modelValue","onChange"])]),_:1}),e(p,{label:"\u64CD\u4F5C",align:"right",width:"120"},{default:t(({row:l})=>[e(h,{type:"primary",onClick:d=>{var f;return(f=n(b))==null?void 0:f.open(l,!0)},link:""},{default:t(()=>[y(" \u7F16\u8F91 ")]),_:2},1032,["onClick"])]),_:1})]),_:1},8,["data","onSelectionChange"])),[[q,m.loading]]),e(Ce,{ref_key:"configRef",ref:b,onLoad:m.load},null,8,["onLoad"])])):N("",!0)])])}}},Xe=B(Be,[["__scopeId","data-v-f0774d69"]]);export{Xe as default};

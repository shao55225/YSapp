import{R as N,E as B,b as F,c as D,d as O,f as Z,g as A,i as H,j as U,k as P,v as z,_ as W,C as G,T as J,o as K,H as Q,m as X}from"./entry-9cc5c370.js";/* empty css                        */import{a as T,Z as E,z as Y,e as j,l as x,m as S,U as l,S as s,a6 as _,u as $,L as v,d as w,p as b,R as ee,W as le,M as k}from"./vue-11eabec3.js";const ae=(g={page:0})=>N({url:"/ads/position",method:"get",params:g}),te=g=>N({url:"/ads/position/batch",method:"delete",data:{ids:g}}),oe=g=>N({url:"/ads/position",method:"post",data:g}),se={__name:"editor",emits:["load"],setup(g,{expose:c,emit:t}){const f=T(),n=E({name:"",englishName:"",adsType:["image","text","custom"],sort:0}),a=E({loading:!1,visible:!1,other:{}}),i=Y("debounce")(r=>{!r||r.validate(e=>{e&&(a.loading=!0,oe(n).then(()=>{B.success({message:a.other.id?"\u5E7F\u544A\u4F4D\u66F4\u65B0\u6210\u529F":"\u5E7F\u544A\u4F4D\u65B0\u589E\u6210\u529F",showClose:!0,position:"bottom-right"}),t("load"),o()}).finally(()=>{a.loading=!1}))})},300),o=()=>{a.other={},a.visible=!1},C={name:{required:!0,message:"\u8BF7\u8F93\u5165\u5E7F\u544A\u4F4D\u540D\u79F0",trigger:"blur"},englishName:[{required:!0,message:"\u8BF7\u8F93\u5165\u82F1\u6587\u6807\u5FD7",trigger:"blur"},{pattern:/^[A-Z|a-z][0-9|A-Z|a-z|_|-]*$/,message:"\u4EC5\u652F\u6301\u6570\u5B57\u3001\u5B57\u6BCD\u3001\u4E0B\u5212\u7EBF\u7EC4\u5408,\u5E76\u4E14\u4EE5\u5B57\u6BCD\u5F00\u5934",trigger:"change"}],adsType:{required:!0,message:"\u8BF7\u9009\u62E9\u5E7F\u544A\u7C7B\u578B",trigger:"blur"}};function p(){var r;Object.keys(n).forEach(e=>{n[e]=a.other[e]||n[e]}),n.id=(r=a.other)==null?void 0:r.id}c({open(r){var e;(e=f.value)==null||e.resetFields(),a.other=r,a.visible=!0}});const V=j(()=>a.other.id?"\u7F16\u8F91\u5E7F\u544A\u4F4D":"\u65B0\u589E\u5E7F\u544A\u4F4D");return(r,e)=>{const d=F,u=D,h=O,y=Z,I=A,M=H,L=U,R=P,q=z;return x(),S("div",null,[l(R,{"model-value":a.visible,"show-close":!a.loading,"close-on-press-escape":!1,title:$(V),width:444,"z-index":20,"close-on-click-modal":!1,onClose:o,onOpened:p},{footer:s(()=>[l(L,{class:"ml-auto",size:"small",loading:a.loading,onClick:o},{default:s(()=>[_(" \u53D6\u6D88 ")]),_:1},8,["loading"]),l(L,{size:"small",loading:a.loading,type:"primary",class:"border-0 bg-orange group-hover:bg-orangeLight",onClick:e[4]||(e[4]=m=>$(i)(f.value))},{default:s(()=>[_(" \u4FDD\u5B58 ")]),_:1},8,["loading"])]),default:s(()=>[v((x(),S("div",null,[l(M,{ref_key:"ruleFormRef",ref:f,model:n,rules:C,"label-width":90,"hide-required-asterisk":!1},{default:s(()=>[l(u,{label:"\u5E7F\u544A\u4F4D\u540D\u79F0",prop:"name"},{default:s(()=>[l(d,{spellcheck:"false",modelValue:n.name,"onUpdate:modelValue":e[0]||(e[0]=m=>n.name=m),modelModifiers:{trim:!0},clearable:"",class:"input",placeholder:"\u8BF7\u8F93\u5165\u5E7F\u544A\u4F4D\u540D\u79F0"},null,8,["modelValue"])]),_:1}),l(u,{label:"\u82F1\u6587\u6807\u5FD7",prop:"englishName"},{default:s(()=>[l(d,{spellcheck:"false",modelValue:n.englishName,"onUpdate:modelValue":e[1]||(e[1]=m=>n.englishName=m),modelModifiers:{trim:!0},clearable:"",disabled:a.other.canUpdate===!1,class:"input",placeholder:"\u8BF7\u8F93\u5165\u82F1\u6587\u6807\u5FD7"},null,8,["modelValue","disabled"])]),_:1}),l(u,{label:"\u5E7F\u544A\u7C7B\u578B",prop:"adsType"},{default:s(()=>[l(y,{modelValue:n.adsType,"onUpdate:modelValue":e[2]||(e[2]=m=>n.adsType=m),multiple:"",placeholder:"\u8BF7\u9009\u62E9\u5E7F\u544A\u7C7B\u578B",size:"default",style:{width:"100%"}},{default:s(()=>[l(h,{label:"\u56FE\u7247",value:"image"}),l(h,{label:"\u6587\u5B57",value:"text"}),l(h,{label:"\u81EA\u5B9A\u4E49",value:"custom"}),l(h,{label:"\u89C6\u9891",value:"video"})]),_:1},8,["modelValue"])]),_:1}),l(u,{label:"\u5E8F\u53F7",prop:"sort"},{default:s(()=>[l(I,{spellcheck:"false",modelValue:n.sort,"onUpdate:modelValue":e[3]||(e[3]=m=>n.sort=m),modelModifiers:{number:!0},clearable:"",precision:0,"step-strictly":"",min:0,"value-on-clear":0,"controls-position":"right",placeholder:"\u8BF7\u8F93\u5165\u5E8F\u53F7"},null,8,["modelValue"])]),_:1})]),_:1},8,["model"])])),[[q,a.loading]])]),_:1},8,["model-value","show-close","title"])])}}};const ne={class:"flex-y box"},ie={class:"flex-x-between"},de={class:"table-tag"},re={class:"table-tag"},ue={class:"table-tag"},ce={class:"table-tag"},pe={__name:"index",setup(g){const c=T({pageIndex:1,pageSize:499,total:0}),t=E({loading:!1,data:[],searchVal:{keywords:"",order:"sort asc"},selectList:[],load(a){c.value=a||c.value,t.loading=!0,ae({page:c.value.pageIndex,limit:c.value.pageSize,...t.searchVal}).then(i=>{t.data=i.list,t.data.forEach(o=>{o.startTime<2e9&&(o.startTime=o.startTime*1e3),o.expirationTime<2e9&&(o.expirationTime=o.expirationTime*1e3)}),c.value.total=i.total}).finally(()=>{t.loading=!1})},handleSelectionChange(a){t.selectList=a},sortChnage({column:a,prop:i,order:o}){o?t.searchVal.order=`${i} ${o==="ascending"?"asc":"desc"}`:t.searchVal.order="",t.load()}}),f=T(),n={del:a=>G({message:"\u786E\u5B9A\u8981\u5220\u9664\u5E7F\u544A\u4F4D\u5417\uFF1F",okEms:"\u5E7F\u544A\u4F4D\u5220\u9664\u6210\u529F"},()=>te(a).then(i=>(t.load(),i)))};return w(()=>{t.load()}),(a,i)=>{const o=U,C=J,p=X,V=K,r=z;return x(),S("div",ne,[b("div",ie,[b("div",null,[l(o,{type:"primary",onClick:i[0]||(i[0]=e=>{var d;return(d=f.value)==null?void 0:d.open({})})},{default:s(()=>[_(" \u65B0\u589E\u5E7F\u544A\u4F4D ")]),_:1}),l(o,{type:"danger",disabled:t.selectList.length<=0,onClick:i[1]||(i[1]=e=>n.del(t.selectList.map(d=>d.id)))},{default:s(()=>[_(" \u6279\u91CF\u5220\u9664 ")]),_:1},8,["disabled"])]),b("div",null,[l(C,{modelValue:t.searchVal.keywords,"onUpdate:modelValue":i[2]||(i[2]=e=>t.searchVal.keywords=e),onChange:i[3]||(i[3]=e=>{c.value.pageIndex=1,t.load()})},null,8,["modelValue"])])]),v((x(),ee(V,{data:t.data,class:"auto",stripe:!0,onSortChange:t.sortChnage,onSelectionChange:t.handleSelectionChange},{default:s(()=>[l(p,{type:"selection",width:"30",selectable:e=>e.canUpdate},null,8,["selectable"]),l(p,{prop:"sort",label:"\u5E8F\u53F7",width:"80",sortable:""},{default:s(({row:e})=>[_(le(e.sort),1)]),_:1}),l(p,{prop:"name",label:"\u5E7F\u544A\u4F4D\u540D\u79F0","show-overflow-tooltip":!0}),l(p,{prop:"englishName",label:"\u82F1\u6587\u6807\u5FD7"}),l(p,{prop:"type",label:"\u4F7F\u7528\u7C7B\u578B"},{default:s(({row:e})=>{var d,u,h,y;return[v(b("span",de,"\u6587\u5B57",512),[[k,(d=e==null?void 0:e.adsType)==null?void 0:d.includes("text")]]),v(b("span",re,"\u56FE\u7247",512),[[k,(u=e==null?void 0:e.adsType)==null?void 0:u.includes("image")]]),v(b("span",ue,"\u81EA\u5B9A\u4E49",512),[[k,(h=e==null?void 0:e.adsType)==null?void 0:h.includes("custom")]]),v(b("span",ce,"\u89C6\u9891",512),[[k,(y=e==null?void 0:e.adsType)==null?void 0:y.includes("video")]])]}),_:1}),l(p,{fixed:"right",label:"\u64CD\u4F5C",align:"right",width:"210px"},{default:s(({row:e})=>[l(o,{type:"primary",link:"",onClick:d=>$(Q)(`<div id'${e.englishName}'></div>`)},{default:s(()=>[_(" \u590D\u5236\u4F7F\u7528\u4EE3\u7801 ")]),_:2},1032,["onClick"]),l(o,{type:"primary",link:"",onClick:d=>{var u;return(u=f.value)==null?void 0:u.open(e)}},{default:s(()=>[_(" \u7F16\u8F91 ")]),_:2},1032,["onClick"]),l(o,{type:"danger",link:"",class:"text-dangerColor",disabled:e.canUpdate===!1,onClick:d=>n.del([e.id])},{default:s(()=>[_(" \u5220\u9664 ")]),_:2},1032,["disabled","onClick"])]),_:1})]),_:1},8,["data","onSortChange","onSelectionChange"])),[[r,t.loading]]),l(se,{ref_key:"editorRef",ref:f,onLoad:t.load},null,8,["onLoad"])])}}},fe=W(pe,[["__scopeId","data-v-a5bdacf4"]]);export{fe as default};

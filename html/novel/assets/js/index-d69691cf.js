import{n as N,y as oe,q as P,w as T,Y as ne,t as Y,x as ue,X as se,r as q,b as M,d as U,c as z,f as j,h as re,a as ie,v as H,_ as O,i as de,j as ce,a2 as pe,l as me}from"./entry-5490c999.js";import"./el-table-column-a25f0439.js";import{F as I,b as V,x as _e,h as K,o as B,c as D,G as X,P as S,u as e,y as G,a6 as fe,a as x,Q as $,R as n,S as ge,V as R,f as be,Y as A,T as l,a5 as C,i as he,ak as Q,K as J,M as ve,al as ye}from"./vue-5906fc2c.js";import{P as Fe}from"./pagination-5ca1e60a.js";import{E as W}from"./el-date-picker-72643638.js";import{_ as Ee,a as ke,g as Ce,c as xe}from"./videoStar-ea710fef.js";import{m as Z}from"./message-26acb8b6.js";import{E as Be}from"./el-input-number-860f564c.js";import{w as Ve}from"./wangEditor-8dd71e06.js";const ee=Symbol("breadcrumbKey"),we=N({separator:{type:String,default:"/"},separatorIcon:{type:oe}}),Ae=I({name:"ElBreadcrumb"}),De=I({...Ae,props:we,setup(p){const v=p,y=P("breadcrumb"),u=V();return _e(ee,v),K(()=>{const t=u.value.querySelectorAll(`.${y.e("item")}`);t.length&&t[t.length-1].setAttribute("aria-current","page")}),(t,r)=>(B(),D("div",{ref_key:"breadcrumb",ref:u,class:S(e(y).b()),"aria-label":"Breadcrumb",role:"navigation"},[X(t.$slots,"default")],2))}});var Ie=T(De,[["__file","/home/runner/work/element-plus/element-plus/packages/components/breadcrumb/src/breadcrumb.vue"]]);const Se=N({to:{type:ne([String,Object]),default:""},replace:{type:Boolean,default:!1}}),$e=I({name:"ElBreadcrumbItem"}),qe=I({...$e,props:Se,setup(p){const v=p,y=be(),u=G(ee,void 0),t=P("breadcrumb"),{separator:r,separatorIcon:s}=fe(u),o=y.appContext.config.globalProperties.$router,_=V(),i=()=>{!v.to||!o||(v.replace?o.replace(v.to):o.push(v.to))};return(E,m)=>(B(),D("span",{class:S(e(t).e("item"))},[x("span",{ref_key:"link",ref:_,class:S([e(t).e("inner"),e(t).is("link",!!E.to)]),role:"link",onClick:i},[X(E.$slots,"default")],2),e(s)?(B(),$(e(Y),{key:0,class:S(e(t).e("separator"))},{default:n(()=>[(B(),$(ge(e(s))))]),_:1},8,["class"])):(B(),D("span",{key:1,class:S(e(t).e("separator")),role:"presentation"},R(e(r)),3))],2))}});var te=T(qe,[["__file","/home/runner/work/element-plus/element-plus/packages/components/breadcrumb/src/breadcrumb-item.vue"]]);const Le=ue(Ie,{BreadcrumbItem:te}),Re=se(te);const ze=p=>q({url:"/chapter",method:"post",prefix:!0,data:p}),Ne=p=>q({url:"/chapter/page/"+p.id,method:"get",prefix:!0,params:p}),Pe=p=>q({url:"/chapter/"+p.novelId,method:"delete",prefix:!0,data:{ids:p.id}}),Te=p=>q({url:"/chapter",method:"put",prefix:!0,data:p}),Ye=p=>q({url:"/chapter/"+p,method:"get",prefix:!0}),Me={style:{display:"flex","align-items":"center",gap:"8px",width:"100%"}},Ue={__name:"allDel",emits:["load"],setup(p,{expose:v,emit:y}){const u=A({loading:!1,visible:!1,other:void 0}),t=V(),r=A({categoryId:[],collectionId:[],updateAtEnd:"",updateAtStart:"",tags:[]});V([]),V([]);const s=m=>{if(r.updateAtEnd)return m.getTime()>r.updateAtEnd.getTime()},o=m=>m.getTime()<new Date(r.updateAtStart).getTime(),_=()=>Z({message:"\u786E\u5B9A\u8981\u5220\u9664\u5417\uFF1F",okEms:"\u56FE\u6587\u6570\u636E\u5220\u9664\u6210\u529F"},()=>t.value.validate((m,g)=>{var F;m&&(u.loading=!0,ke({collectionId:r.collectionId,updateAtStart:r.updateAtStart||void 0,updateAtEnd:r.updateAtEnd||void 0,categoryId:(F=r.categoryId)==null?void 0:F.map(d=>d.at(-1)),tags:r.tags||[]}).then(d=>{u.visible=!1}).finally(()=>{u.loading=!1}))})),i=()=>{var m;u.visible=!1,(m=t.value)==null||m.resetFields(),r.updateAtStart="",r.updateAtEnd="",r.tags=[],y("load")},E=()=>{};return v({open(m){u.visible=!0}}),(m,g)=>{const F=M,d=W,a=U,f=z,b=j;return B(),$(b,{"model-value":e(u).visible,"show-close":!e(u).loading,"close-on-press-escape":!1,title:"\u4E00\u952E\u5220\u9664",width:550,"z-index":20,top:"25vh","close-on-click-modal":!1,onClose:i,onOpened:E},{footer:n(()=>[l(f,{class:"ml-auto",size:"small",loading:e(u).loading,onClick:i},{default:n(()=>[C(" \u53D6\u6D88 ")]),_:1},8,["loading"]),l(f,{class:"ml-auto",size:"small",type:"primary",loading:e(u).loading,onClick:g[3]||(g[3]=c=>_())},{default:n(()=>[C(" \u4FDD\u5B58 ")]),_:1},8,["loading"])]),default:n(()=>[l(a,{ref_key:"ruleFormRef",ref:t,"label-width":"80px",model:e(r),rules:{},"hide-required-asterisk":!1},{default:n(()=>[l(F,{label:"\u56FE\u6587\u5206\u7C7B",prop:"categoryId"},{default:n(()=>[l(Ee,{modelValue:e(r).categoryId,"onUpdate:modelValue":g[0]||(g[0]=c=>e(r).categoryId=c),style:{width:"100%"},type:"article",placeholder:"\u9ED8\u8BA4\u5168\u90E8\u5206\u7C7B",checkStrictly:!0,props:{checkStrictly:!1,multiple:!0,emitPath:!0}},null,8,["modelValue"])]),_:1}),l(F,{label:"\u66F4\u65B0\u65F6\u95F4",prop:["updateAtStart","updateAtEnd"]},{default:n(()=>[x("div",Me,[l(d,{modelValue:e(r).updateAtStart,"onUpdate:modelValue":g[1]||(g[1]=c=>e(r).updateAtStart=c),type:"datetime",placeholder:"\u5F00\u59CB\u65E5\u671F",style:{flex:"1 1"},"disabled-date":s,format:"YYYY/MM/DD HH:mm:ss",clearable:!1},null,8,["modelValue"]),C(" ~ "),l(d,{modelValue:e(r).updateAtEnd,"onUpdate:modelValue":g[2]||(g[2]=c=>e(r).updateAtEnd=c),type:"datetime",style:{flex:"1 1"},"disabled-date":o,placeholder:"\u7ED3\u675F\u65E5\u671F",format:"YYYY/MM/DD HH:mm:ss",clearable:!1},null,8,["modelValue"])])]),_:1})]),_:1},8,["model"])]),_:1},8,["model-value","show-close"])}}},je=Ue,He={class:"hhhh"},Oe={class:"flex-x-between"},Ke={class:"block"},Xe={class:"block"},Ge={style:{"line-height":"32px"}},Qe=I({__name:"editor",emits:["load"],setup(p,{expose:v,emit:y}){const u=A({loading:!1,list:[],fn(d){u.loading=!0,xe({keywords:d}).then(a=>{console.log(a,"===="),u.list=a.list}).finally(()=>{u.loading=!1})}}),t=Q(),r=V(),s=A({id:0,title:"",siteId:Number(sessionStorage.getItem("site")),number:1,novelId:Number(t.query.id),volume:"",releaseDate:null,content:""}),o=A({loading:!1,visible:!1,other:void 0}),_=G("debounce")(d=>{!d||d.validate(a=>{a&&(o.loading=!0,(s.id?Te(s):ze(s)).then(()=>{var f;re({position:"bottom-right",type:"success",message:(f=o.other)!=null&&f.id?"\u5C0F\u8BF4\u7AE0\u8282\u66F4\u65B0\u6210\u529F":"\u5C0F\u8BF4\u7AE0\u8282\u65B0\u589E\u6210\u529F"}),y("load"),i()}).finally(()=>{o.loading=!1}))})},300),i=()=>{o.other=void 0,o.visible=!1,s.content="",u.list=[]},E={title:{required:!0,message:"\u8BF7\u8F93\u5165\u7AE0\u8282\u6807\u9898",trigger:"blur"},number:{required:!0,message:"\u8BF7\u8F93\u5165\u7AE0\u8282\u6570",trigger:"blur"},releaseDate:{required:!0,message:"\u8BF7\u9009\u62E9\u53D1\u5E03\u65F6\u95F4",trigger:"blur"},volume:{required:!0,message:"\u8BF7\u8F93\u5165\u5377\u540D",trigger:"blur"},cover:{required:!0,message:"\u8BF7\u8F93\u5165\u5C01\u9762\u5730\u5740",trigger:"blur"},intro:{required:!0,message:"\u8BF7\u8F93\u5165\u7B80\u4ECB",trigger:"blur"},content:{required:!0,message:"\u8BF7\u8F93\u5165\u7AE0\u8282\u5185\u5BB9",trigger:"blur"}},m=V([]);Ce({limit:9999}).then(d=>{m.value=d.list});function g(){var d,a;(d=o.other)!=null&&d.id?(o.loading=!0,Ye((a=o.other)==null?void 0:a.id).then(f=>{o.loading=!1,Object.keys(s).forEach(b=>{s[b]=(f==null?void 0:f[b])||s[b]})}).finally(()=>{o.loading=!1})):s.id=0}v({open(d){var a;(a=r.value)==null||a.resetFields(),o.visible=!0,o.other=d}});const F=he(()=>{var d;return(d=o.other)!=null&&d.id?"\u7F16\u8F91\u5C0F\u8BF4\u7AE0\u8282":"\u65B0\u589E\u5C0F\u8BF4\u7AE0\u8282"});return(d,a)=>{const f=ie,b=M,c=W,h=Be,w=U,L=z,le=j,ae=H;return B(),D("div",He,[l(le,{"model-value":e(o).visible,"show-close":!e(o).loading,"close-on-press-escape":!1,title:e(F),width:750,"z-index":20,"close-on-click-modal":!1,onClose:i,onOpened:g,top:"10vh"},{footer:n(()=>[l(L,{class:"ml-auto",size:"small",loading:e(o).loading,onClick:i},{default:n(()=>[C(" \u53D6\u6D88 ")]),_:1},8,["loading"]),l(L,{size:"small",loading:e(o).loading,type:"primary",class:"border-0 bg-orange group-hover:bg-orangeLight",onClick:a[5]||(a[5]=k=>e(_)(e(r)))},{default:n(()=>[C(" \u4FDD\u5B58 ")]),_:1},8,["loading"])]),default:n(()=>[J((B(),D("div",null,[l(w,{ref_key:"ruleFormRef",ref:r,"label-width":"80px",model:e(s),rules:E,"hide-required-asterisk":!1},{default:n(()=>[x("div",Oe,[x("div",Ke,[l(b,{label:"\u7AE0\u8282\u6807\u9898",prop:"title"},{default:n(()=>[l(f,{spellcheck:"false",modelValue:e(s).title,"onUpdate:modelValue":a[0]||(a[0]=k=>e(s).title=k),modelModifiers:{trim:!0},clearable:"",placeholder:"\u8BF7\u8F93\u5165\u7AE0\u8282\u6807\u9898"},null,8,["modelValue"])]),_:1}),l(b,{label:"\u5377\u540D",prop:"volume"},{default:n(()=>[l(f,{spellcheck:"false",modelValue:e(s).volume,"onUpdate:modelValue":a[1]||(a[1]=k=>e(s).volume=k),modelModifiers:{trim:!0},clearable:"",placeholder:"\u8BF7\u8F93\u5165\u5377\u540D"},null,8,["modelValue"])]),_:1})]),x("div",Xe,[l(b,{label:"\u53D1\u5E03\u65F6\u95F4",prop:"releaseDate"},{default:n(()=>[l(c,{modelValue:e(s).releaseDate,"onUpdate:modelValue":a[2]||(a[2]=k=>e(s).releaseDate=k),modelModifiers:{number:!0},type:"datetime",placeholder:"\u9009\u62E9\u65E5\u671F\u65F6\u95F4",style:{width:"100%"},"value-format":"X"},null,8,["modelValue"])]),_:1}),l(b,{label:"\u7AE0\u8282\u6570",prop:"number"},{default:n(()=>[l(h,{modelValue:e(s).number,"onUpdate:modelValue":a[3]||(a[3]=k=>e(s).number=k),min:1,"controls-position":"right",placeholder:"\u8BF7\u8F93\u5165\u7AE0\u8282\u6570"},null,8,["modelValue"])]),_:1})])]),l(b,{label:"\u5185\u5BB9"},{default:n(()=>[x("div",Ge,[e(o).visible?(B(),$(Ve,{key:0,"model-value":e(s).content,"onUpdate:modelValue":a[4]||(a[4]=k=>e(s).content=k==="<p><br></p>"?"":k),height:"400px",style:{"z-index":"9"}},null,8,["model-value"])):ve("",!0)])]),_:1})]),_:1},8,["model"])])),[[ae,e(o).loading]])]),_:1},8,["model-value","show-close","title"])])}}});const Je=O(Qe,[["__scopeId","data-v-bf6cbe59"]]),We={class:"flex-y box"},Ze={style:{display:"flex",gap:"1px","align-items":"center"}},et={class:"flex-x-between search"},tt={class:"flex-center",style:{gap:"16px","font-size":"12px"}},lt=["onClick"],at=I({__name:"index",setup(p){const v=ye(),y=Q();console.log(y.query.id);const u=V({pageIndex:1,pageSize:20,total:0}),t=A({loading:!1,data:[],searchVal:{keywords:""},selectList:[],load(_){u.value=_||u.value,t.loading=!0,Ne({offset:(u.value.pageIndex-1)*u.value.pageSize,limit:u.value.pageSize,id:y.query.id,...t.searchVal}).then(i=>{t.data=i.list,u.value.total=i.total}).finally(()=>{t.loading=!1})},handleSelectionChange(_){t.selectList=_},sortChnage({column:_,prop:i,order:E}){E?t.searchVal.order=`${i} ${E==="ascending"?"asc":"desc"}`:t.searchVal.order="",t.load()}}),r=V(),s=V(),o={del:_=>Z({message:"\u786E\u5B9A\u8981\u5220\u9664\u5417\uFF1F",okEms:"\u5C0F\u8BF4\u7AE0\u8282\u5220\u9664\u6210\u529F"},()=>Pe({id:_,novelId:Number(y.query.id)}).then(i=>(t.load(),i))),search:()=>{u.value.pageIndex=1,t.load()},statusChange(_,i){t.loading||(i.loading=!0)}};return K(()=>{t.load()}),(_,i)=>{const E=Y,m=Re,g=Le,F=z,d=de,a=me,f=ce,b=H;return B(),D("div",We,[l(g,null,{default:n(()=>[l(m,{to:{name:"novel"}},{default:n(()=>[x("span",Ze,[l(E,null,{default:n(()=>[l(e(pe))]),_:1}),C(" \u8FD4\u56DE")])]),_:1}),l(m,null,{default:n(()=>{var c,h;return[C(R((h=(c=e(v))==null?void 0:c.currentRoute.value.query)==null?void 0:h.novelname),1)]}),_:1})]),_:1}),x("div",et,[x("div",null,[l(F,{type:"primary",onClick:i[0]||(i[0]=c=>{var h;return(h=s.value)==null?void 0:h.open({})})},{default:n(()=>[C(" \u65B0\u589E\u5C0F\u8BF4\u7AE0\u8282 ")]),_:1}),l(F,{type:"danger",disabled:t.selectList.length<=0,onClick:i[1]||(i[1]=c=>o.del(t.selectList.map(h=>h.id)))},{default:n(()=>[C(" \u6279\u91CF\u5220\u9664 ")]),_:1},8,["disabled"])]),x("div",tt,[l(d,{modelValue:t.searchVal.keywords,"onUpdate:modelValue":i[2]||(i[2]=c=>t.searchVal.keywords=c),onChange:o.search},null,8,["modelValue","onChange"])])]),J((B(),$(f,{data:t.data,class:"auto",stripe:!0,onSortChange:t.sortChnage,onSelectionChange:t.handleSelectionChange},{default:n(()=>[l(a,{type:"selection",width:"55"}),l(a,{type:"index",label:"\u5E8F\u53F7"},{default:n(({row:c,store:h,$index:w})=>[x("div",{onClick:L=>h.toggleRowSelection(c,void 0)},R(w+1),9,lt)]),_:1}),l(a,{prop:"title",label:"\u7AE0\u8282\u6807\u9898","min-width":"150","show-overflow-tooltip":!0}),l(a,{prop:"volume",label:"\u5377\u540D","min-width":"150","show-overflow-tooltip":!0}),l(a,{prop:"number",label:"\u7AE0\u8282\u53F7","min-width":"150","show-overflow-tooltip":!0}),l(a,{prop:"releaseDate",label:"\u53D1\u5E03\u65F6\u95F4",type:"date",width:"150",sortable:""}),l(a,{fixed:"right",label:"\u64CD\u4F5C",align:"right","min-width":"150"},{default:n(({row:c})=>[l(F,{type:"primary",link:"",onClick:h=>{var w;return(w=s.value)==null?void 0:w.open(c)}},{default:n(()=>[C(" \u7F16\u8F91 ")]),_:2},1032,["onClick"]),l(F,{type:"danger",link:"",onClick:h=>o.del([c.id])},{default:n(()=>[C(" \u5220\u9664 ")]),_:2},1032,["onClick"])]),_:1})]),_:1},8,["data","onSortChange","onSelectionChange"])),[[b,t.loading]]),l(Fe,{pageinfo:u.value,onChange:t.load},null,8,["pageinfo","onChange"]),l(Je,{ref_key:"editorRef",ref:s,onLoad:t.load},null,8,["onLoad"]),l(je,{ref_key:"allDelVueRef",ref:r,onLoad:t.load},null,8,["onLoad"])])}}});const mt=O(at,[["__scopeId","data-v-a24e2466"]]);export{mt as default};
